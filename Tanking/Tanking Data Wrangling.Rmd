---
title: "Tanking Data Wrangling"
author: "Erik Larsen"
date: "4/23/2022"
output:
  html_document:
    toc: true
    toc_float:
      collapsed: true
    numbered_sections: true
    code_folding: hide
---

# Overview

This snippet was used in my article (currently under review) on [TheLeftyCatcher](https://www.theleftycatcher.com), where I compared and contrasted how `Jeff Luhnow` and `Theo Epstein` tanked to rebuild the `Chicago Cubs` and `Houston Astros`, beginning in ~2011 into World Series winners.

I acquired `MLB Free Agent` data, `MLB Amateur Draft` data, `International Signing` data, `MLB Standings` data, `MLB Payroll` data, and "`MLB Value`" data. I scraped or downloaded this data from multiple sites, including `Baseball Reference`, `ESPN`, and `Baseball Almanac`. It required some processing to compile and analyze with or without graphs.

Subsequent pieces and snippets will revolve around this data.

The functions used are sourced from (this)[] file.

# Environment Prep {.tabset .tabset-pills .tabset-fade}

Load packages and functions

## Load packages

```{r Load packages, include = T, warning = F, message = F, echo = T}
  ## Data wrangling; df re-arrangement, string manipulations
library(readr)
library(reshape2)
library(tidyverse)
library(stringr)
library(stringi)

  ## Web scraping
library(rvest)
library(XML)

  ## Plotting
library(ggplot2)
library(ggrepel)
library(GGally)
library(ggpubr)
library(plotly)

  ## Modeling
library(mgcv)
library(splines)

source("~/GitHub/Baseball/Tanking/Tanking Functions.R")
```

# Amateur Draft Data {.tabset .tabset-pills .tabset-fade}

## Scrape and Clean Amateur Draft Data

Scrape amateur draft data from `Baseball Almanac`

Data is rife with errors, so clean it up

```{r Scrape and Clean Amateur draft data, include = T, message = F, warning = F, echo = T}
  ## set the selector
almanac_selector = "#wrapper > div.container > div.ba-table > table"
  ## Loop through and scrape the data starting from Epstein and Luhnow hires with Cubs/Astros (2011) to present
for ( i in 11:21 ){
  BBA_IMPORT_fn(Year = i, selector = almanac_selector)
}
  ## Merge the dataframes together
BBA_DRAFT_ALL = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "BBA20") == TRUE)]), full_join)
rm(list = ls()[which(grepl(ls(), pattern = "BBA([0-9])") == T)])

Encoding(BBA_DRAFT_ALL$`Player Name`) = "UTF-8"
BBA_DRAFT_ALL$`Player Name` = iconv(BBA_DRAFT_ALL$`Player Name`, "UTF-8", "UTF-8", sub = " ")


  ## Fix team name mistakes
    ## Change " `Drafted By` " to "Tm", and " `Player Name` " to "Name"
BBA_DRAFT_ALL = BBA_DRAFT_ALL %>%
  dplyr::mutate(`Drafted By` = case_when(`Drafted By` == "Chicago" ~ "Chicago Cubs",
                                         `Drafted By` == "Florida Marlins" ~ "Miami Marlins",
                                         grepl(`Drafted By`, pattern = "Miami") ~ "Miami Marlins",
                                         grepl(`Drafted By`, pattern = "Phillies") ~ "Philadelphia Phillies",
                                         grepl(`Drafted By`, pattern = "Pittsburg") ~ "Pittsburgh Pirates",
                                         grepl(`Drafted By`, pattern = "Baltimore") ~ "Baltimore Orioles",
                                         grepl(`Drafted By`, pattern = "Athletics") ~ "Oakland Athletics",
                                         grepl(`Drafted By`, pattern = "Anaheim") ~ "Los Angeles Angels",
                                         grepl(`Drafted By`, pattern = "Senators") ~ "Oakland Athletics",
                                         TRUE ~ `Drafted By`),
                Tm = `Drafted By`,
                Name = `Player Name`) %>%
  dplyr::select(-`Drafted By`, -`Player Name`)
```

# Baseball Reference Standings Data {.tabset .tabset-pills .tabset-fade}

Import `Baseball Reference`'s `Standings` data over relevant years

## Scrape and Clean Baseball Reference Standings Data

```{r Scrape standings data from Baseball Reference, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Loop through and import the standings from 2011-2021
for ( i in 11:21 ) {
  if (i %% 10 == 0 ) {
    
    Sys.sleep(60)
    
  } else {
    
    BR_STAND_IMPORT_fn(Year = i)
    
  }
}
  ## merge the dfs together
StandALL = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "Standings") == TRUE)]), full_join)
  ## correct team name changes
StandALL = StandALL %>%
  dplyr::mutate(Tm = case_when(grepl(Tm, pattern = "Angels") ~ "Los Angeles Angels",
                               grepl(Tm, pattern = "Florida") ~ "Miami Marlins",
                               grepl(Tm, pattern = "Indians") ~ "Cleveland Guardians",
                               TRUE ~ Tm))
  ## remove the individual dfs
rm(list = ls()[which(grepl(ls(), pattern = "Standings") == T)])
```

# Baseball Reference Player Value Data {.tabset .tabset-pills .tabset-fade}

Import `BBRef`'s `player value` data, originally scraped from `BBRef`

## Import "player value" Data from `Baseball Reference`

Import the data from Git repo

```{r Old BR Import, include = F, warning = F, message = F, echo = F}
  ## Import player value stats downloaded from Baseball Reference
# setwd("C:/Users/Erik/Desktop/BoxCopy/Programming Scripts and Data/Baseball/Projects/Tanking/")
# files = list.files(pattern = "Player_Value")
# for ( i in 1:length(files) ) {
#   as.data.frame(
#     assign(
#       gsub(".csv", "", files[], fixed = TRUE)[i], read.csv(file = files[i]))
#   )
# }

# files = list.files(path = "https://raw.githubusercontent.com/eriklarsen4/Baseball/main/Tanking/Player%20Value%20files")
# for (i in 1:length(files) ) {
#   as.data.frame(
#     assign(
#       gsub(".csv", "", files[], fixed = TRUE)[i], read.csv(file = paste("https://github.com/eriklarsen4/Baseball/tree/main/Tanking/Player%20Value%20files",files[i], sep = ""), encoding = "UTF8")
#     )
#   )
# }

#   ## Re-name them to include underscores
#     ##  First, concatenate the dataframe names into a list
# BR_list = ls()[
#   which(grepl(ls(), pattern = "Value") == TRUE)
# ]
#     ## Replace the spaces with underscores and assign the files to the names
# for(i in 1:length(unlist(BR_list))){
#     
#     BR_list[i] = gsub(" ", "_", ls()[
#       which(grepl(ls(), pattern = "BR") == TRUE)[i]
#     ], fixed = TRUE)
#     
#     as.data.frame(
#       assign(unlist(BR_list)[i], read.csv(file = paste("https://github.com/eriklarsen4/Baseball/tree/main/CVSL/FG%20and%20BR%20Data", files[i], sep = ""), encoding = "UTF8")
#     )
#     )
# }
```

```{r Import player WAR and salary data from BBRef, include = F, warning = F, message = F, echo = F}
rm(list = ls()[which(grepl(ls(), pattern = "Player_Value_"))])
rm(Player_Value_Pitching_ALL)


batter_files = vector()
pitcher_files = vector()

for (i in 1:length(2011:2021)){
  batter_files[i] = c(
    paste("https://raw.githubusercontent.com/eriklarsen4/Baseball/main/Tanking/Player%20Value%20files/Player_Value_Batting_",2010+i,".csv", sep = "")
  )
  
  as.data.frame(
  assign(
    str_extract(batter_files[i], pattern = paste("Player_Value_Batting_", 2010+i, sep = "")),
    read.csv(file = batter_files[i], encoding = "UTF-8")
  )
)
  
  pitcher_files[i] = c(
      paste("https://raw.githubusercontent.com/eriklarsen4/Baseball/main/Tanking/Player%20Value%20files/Player_Value_Pitching_",2010+i,".csv", sep = "")
    )
  
  as.data.frame(
    assign(
      str_extract(pitcher_files[i], pattern = paste("Player_Value_Pitching_", 2010+i, sep = "")),
      read.csv(file = pitcher_files[i], encoding = "UTF-8")
    )
  )
}

## 2020, 2021 have Xinn value added for pitchers; remove it to join and clean
Player_Value_Pitching_2020 = Player_Value_Pitching_2020[ , -13]
Player_Value_Pitching_2021 = Player_Value_Pitching_2021[ , -13]

  ## Add Year column
Batting.list = mget(ls()[which(grepl(ls(), pattern = "Batting"))])
Pitching.list = mget(ls()[which(grepl(ls(), pattern = "Pitching"))])

Batting.list = lapply(Batting.list, transform, Year = 0)
Pitching.list = lapply(Pitching.list, transform, Year = 0)

for (i in 1:length(Batting.list)) {
  
  Batting.list[[i]]$Year = as.numeric(paste(2010+i, sep = ""))
  Pitching.list[[i]]$Year = as.numeric(paste(2010+i, sep = ""))
  
  assign(ls()[which(grepl(ls(), pattern = paste("Batting_", 2010+i, sep = "")) == T)],
         as.data.frame(Batting.list[[i]])
         )
  
  assign(ls()[which(grepl(ls(), pattern = paste("Pitching_", 2010+i, sep = "")) == T)],
         as.data.frame(Pitching.list[[i]])
         )
  
}


```

```{r Import Player Value Data from BBRef, include = T, warning = F, message = F, echo = T}
## compile player type data into a list over which to loop
# batter_files = vector()
# pitcher_files = vector()

rm(list = ls()[which(grepl(ls(), pattern = "Player_Value") == T)])

for ( i in 11:21 ){
  if (i %% 10 == 0 ) {
    
      Sys.sleep(60)
    
    } else {
      
      BR_PLAYER_VAL_IMPORT_fn(Year = i, Player_data_type = "batting")
      BR_PLAYER_VAL_IMPORT_fn(Year = i, Player_data_type = "pitching")
  
    }
}

```


## Clean the BR Player Value Data

Clean the data

```{r Join BBRef data and correct columns, include = T, warning = F, message = F, echo = T}
  ## Combine the each data "type" into one df
Player_Value_Batting_ALL = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "Value_batting") == T)]), full_join)

# Player_Value_pitching_2021 = Player_Value_pitching_2021 %>%
#   dplyr::select(-RA9extras)
Player_Value_Pitching_ALL = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "Value_pitching") == T)]), full_join)
  ## remove individual (yearly) dfs
rm(list = ls()[which(grepl(ls(), pattern = "batting_2|pitching_2") == T)])

Player_Value_Pitching_ALL = BR_PLAYER_VAL_CLEAN_fn(df = Player_Value_Pitching_ALL, Player_data_type = "pitching")
Player_Value_Batting_ALL = BR_PLAYER_VAL_CLEAN_fn(df = Player_Value_Batting_ALL, Player_data_type = "batting")

pitchernames = Player_Value_Pitching_ALL %>%
  dplyr::select(Name) %>%
  as.vector() %>%
  unlist() %>%
  as.character()
hitternames = Player_Value_Batting_ALL %>%
  dplyr::select(Name) %>%
  as.vector() %>%
  unlist() %>%
  as.character()


## use the Chadwick DB as a cross-ref for playerids
CHAD_LU = baseballr::chadwick_player_lu()

  ## concatenate the separated strings for players with initials as first names;
  ## remove players without bbref ids and remove excess columns
CHAD_LU = CHAD_LU %>%
  dplyr::mutate(name_first = case_when(grepl(name_first, pattern = "[A-Z]\\.") ~
                                         gsub(name_first, pattern = "\\s", replacement = ""),
                                       TRUE ~ name_first)) %>%
  dplyr::filter(key_bbref != "") %>%
  dplyr::mutate(Name = paste(name_first, name_last, sep = " ")) %>%
  dplyr::select(contains("name"),
                contains("Name"),
                key_mlbam,
                key_bbref,
                key_fangraphs,
                key_retro,
                contains("mlb_played"))

## because of encoding discrepancies, will need to loop through and assign bbref ids and last initials for each player in the dataset
  ## function created for this
    ## used to enable scraping individual bbref pages (for when players changed teams in this project)
Player_Value_Batting_ALL = ID_ADD_fn(df = Player_Value_Batting_ALL, player_type = "hitters", site_abbrev = "bbref")

Player_Value_Pitching_ALL = ID_ADD_fn(df = Player_Value_Pitching_ALL, player_type = "pitchers", site_abbrev = "bbref")

Player_Value_Pitching_ALL_2 %>%
  dplyr::filter(is.na(bbref_id))


Player_Value_Pitching_ALL_2 %>%
  dplyr::filter(!grepl(Name, pattern = "Jr." ) &
                  !grepl(Name, pattern = "III") &
                  is.na(bbref_id))

Player_Value_Pitching_ALL_3 %>%
  dplyr::filter(is.na(bbref_id)) &
                  grepl(Name, pattern = "Josh") &
                  grepl(Name, pattern = "D.")) &
                  grepl(Name, pattern = "Le"))


```

```{r Correct player name spellings and ids 1, eval = T, include = F, warning = F, message = F, echo = F}

## correct names that impacted ids and last name initials
  ## -> all juniors, players with accents, or different first names between CHAD and bbref

Player_Value_Batting_ALL = Player_Value_Batting_ALL %>%
  
  
  dplyr::mutate(bbref_id = case_when(grepl(Name, pattern = "Jackie") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Jackie Bradley")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Vladimir") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Vladimir Guerrero") &
                                                       grepl(key_bbref, pattern = "2")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Souza") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Souza") &
                                                       grepl(name_first, pattern = "Steven")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Ronald") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Ronald") &
                                                       grepl(name_matrilineal, pattern = "Blanco")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Dwight") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Dwight Smith") &
                                                       grepl(name_suffix, pattern = "Jr.")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Lourdes") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Lourdes")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Shed") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Shed")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Tatis") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Fernando Tat")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "LaMonte") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "LaMonte Wade")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jazz") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Jazz")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Kazmar") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Kazmar")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Luis") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Luis Robert")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Stokes") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Troy Stokes")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jr.") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Eric Young") &
                                                       grepl(name_suffix, pattern = "Jr.")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     TRUE ~ bbref_id
                                     ),
                lastinit = str_extract(bbref_id, pattern = "[a-z]{1}"),
                
                
                ## correct additional oddities
                bbref_id = case_when(grepl(Name, pattern = "Alejandro") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "De Aza")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Iv") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Iv") &
                                                       grepl(name_last, pattern = "De Jes")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Wily") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_first, pattern = "Wily Mo")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Van") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Van") &
                                                       grepl(name_first, pattern = "Scott")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Dekker") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_last, pattern = "den Dekker")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Gosselin") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Gosselin")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Murphy") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Murphy") &
                                                       grepl(name_given, pattern = "John Ryan")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Tommy") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Tommy") &
                                                       grepl(name_given, pattern = "Thomas Frank")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Yolmer") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Yolmer")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Michael") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Michael Taylor") &
                                                       grepl(name_given, pattern = "Michael A")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Kang") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Kang")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Choi") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Choi") &
                                                       grepl(name_given, pattern = "Ji Man")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Hyun") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Hyun") &
                                                       grepl(name_first, pattern = "Hyun Soo")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Byung") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_first, pattern = "Byung Ho")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Reed") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Reed") &
                                                       grepl(name_given, pattern = "Andrew Joseph")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Vogelbach") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Vogelbach")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Nicky") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Delmonico")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Granite") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Granite")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Fernandez") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Jos") &
                                                       grepl(key_bbref, pattern = "fernajo03")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Alex") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_first, pattern = "Alex") &
                                                       grepl(name_last, pattern = "De Goti")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Bryan") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_first, pattern = "Bryan") &
                                                       grepl(name_last, pattern = "De La Cruz")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     
                                     TRUE ~ bbref_id
                                     ),
                
                ## and their lastname initial
                lastinit = str_extract(bbref_id, pattern = "[a-z]{1}")
                )

Player_Value_Pitching_ALL = Player_Value_Pitching_ALL %>%
  dplyr::mutate(bbref_id = case_when(grepl(Name, pattern = "III") &
                                       grepl(Name, pattern = "Alvarez") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_first, pattern = "Henderson")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "III") &
                                       grepl(Name, pattern = "Vidal") ~ CHAD_LU %>%
                                       dplyr::filter(key_bbref == "nunovi01") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jr.") &
                                       grepl(Name, pattern = "Fernando") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_first, pattern = "Fernando") &
                                                       grepl(name_last, pattern = "Rodr")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jr.") &
                                       grepl(Name, pattern = "Carl") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_first, pattern = "Carl") &
                                                       grepl(name_last, pattern = "Edwards")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jr.") &
                                       grepl(Name, pattern = "Lance") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "McCullers") &
                                                       name_suffix == "Jr.") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jr.") &
                                       grepl(Name, pattern = "Wright") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_first, pattern = "Mike") &
                                                       grepl(name_last, pattern = "Wright")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jr.") &
                                       grepl(Name, pattern = "Leiter") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Leiter") &
                                                       name_suffix == "Jr.") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jr.") &
                                       grepl(Name, pattern = "Underwood") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_last, pattern = "Underwood") &
                                                       grepl(name_given, pattern = "Duane Lee")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jr.") &
                                       grepl(Name, pattern = "Flores") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_last, pattern = "Flores") &
                                                       grepl(name_first, pattern = "Bernardo")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jr.") &
                                       grepl(Name, pattern = "Honeywell") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_last, pattern = "Honeywell")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     TRUE ~ bbref_id),
                
                ## Des
                bbref_id = case_when(grepl(Name, pattern = "De") &
                                       is.na(bbref_id) &
                                       grepl(Name, pattern = "Justin") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Justin" &
                                                       grepl(name_last, pattern = "Fratus")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "De") &
                                       is.na(bbref_id) &
                                       grepl(Name, pattern = "Frankie") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_last, pattern = "De") &
                                                       grepl(name_first, pattern = "Frankie")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "De") &
                                       is.na(bbref_id) &
                                       grepl(Name, pattern = "Dane") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Dane" &
                                                       grepl(name_last, pattern = "Rosa")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "De") &
                                       is.na(bbref_id) &
                                       grepl(Name, pattern = "Jorge") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Jorge" &
                                                       grepl(name_last, pattern = "De La")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "De") &
                                       is.na(bbref_id) &
                                       grepl(Name, pattern = "Rubby") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Rubby") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "De") &
                                       grepl(Name, pattern = "Eury") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Eury" &
                                                       name_last == "De La Rosa") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Fautino") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Fautino") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Enerio") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Enerio") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Cole") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Cole" &
                                                       name_last == "De Vries") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jose") &
                                       grepl(Name, pattern = "Torre") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Jose" &
                                                       name_last == "De La Torre") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "De") &
                                       is.na(bbref_id) &
                                       grepl(Name, pattern = "Jorge") &
                                       grepl(Name, pattern = "Leon") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Jorge" &
                                                       name_last == "De Leon") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Abel") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Abel" &
                                                       name_last == "De Los Santos") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Paula") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Jose" &
                                                       name_last == "De Paula") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "De") &
                                       grepl(Name, pattern = "Joel") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Joel" &
                                                       name_last == "De La Cruz") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "De") &
                                       is.na(bbref_id) &
                                       grepl(Name, pattern = "Jos") &
                                       grepl(Name, pattern = "Le") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Jos") &
                                                       grepl(name_given, pattern = "Eugenio")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Jong") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Chase" &
                                                       name_last == "De Jong") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Enyel") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Enyel") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Pozo") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Pozo") &
                                                       name_first == "Miguel") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     is.na(bbref_id) &
                                       grepl(Name, pattern = "Hurk") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "van den Hurk")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     is.na(bbref_id) &
                                       grepl(Name, pattern = "Oviedo") ~ CHAD_LU %>%
                                       dplyr::filter(name_given == "Juan Carlos" &
                                                       name_last == "Oviedo") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     is.na(bbref_id) &
                                       grepl(Name, pattern = "Niese") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Niese") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     is.na(bbref_id) &
                                       grepl(Name, pattern = "JC") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "J") &
                                                       grepl(Name, pattern = "C") &
                                                       grepl(Name, pattern = "Ram")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Ryu") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Ryu" &
                                                       name_first == "Hyun Jin") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     TRUE ~ bbref_id),
                
                ## misfits
                bbref_id = case_when(grepl(Name, pattern = "Boyd") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Boyd" &
                                                       grepl(Name, pattern = "Matt")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Chi") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Chi Chi")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Sugar") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(Name, pattern = "Sugar Ray")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Josh") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_first, pattern = "Josh") &
                                                       name_given == "Joshua Allen") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Felipe") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_last, pattern = "V") &
                                                       name_given == "Felipe Javier") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Bowman") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Bowman" &
                                                       name_first == "Matthew") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Chargois") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Chargois") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Whalen") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Whalen") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Chasen Bradford") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Chase" &
                                                       name_given == "Chasen David") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Infante") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Infante" &
                                                       grepl(name_first, pattern = "Greg")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "King") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "King" &
                                                       grepl(name_first, pattern = "Mi")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Reed") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Reed" &
                                                       name_first == "A.J.") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Lakins") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Travis" &
                                                       name_last == "Lakins") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Ponce") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Daniel" &
                                                       grepl(name_last, pattern = "Ponce")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Josh") &
                                       is.na(bbref_id) &
                                       grepl(Name, pattern = "D.") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_first, pattern = "Josh") &
                                                       name_given == "Joshua Dwayne") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Lakins") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Travis" &
                                                       name_last == "Lakins") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Locke") ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Locke") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Daniel") &
                                       is.na(bbref_id) &
                                       grepl(Name, pattern = "Cam") ~ CHAD_LU %>%
                                       dplyr::filter(grepl(name_first, pattern = "Dan") &
                                                       grepl(name_last, pattern = "Cam")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Vladimir") &
                                       is.na(bbref_id) ~ CHAD_LU %>%
                                       dplyr::filter(name_first == "Vladimir" &
                                                       grepl(name_last, pattern = "Guti")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Kwang") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Kim" &
                                                       grepl(name_first, pattern = "Kwang")) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Lynch") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Lynch" &
                                                       name_first == "Daniel") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     TRUE ~ bbref_id
                                     ),
                lastinit = str_extract(bbref_id, pattern = "[a-z]{1}")
  ) %>%
  dplyr::filter(!is.na(bbref_id))
```

```{r Correct player name spellings and ids 2, include = T, message = F, warning = F, echo = F}
Player_Value_Batting_ALL = Player_Value_Batting_ALL %>%
  dplyr::mutate(bbref_id = case_when(grepl(Name, pattern = "Bill") &
                                       grepl(Name, pattern = "Hall") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Hall" &
                                                       name_given == "William") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "John") &
                                       grepl(Name, pattern = "McDonald") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "McDonald" &
                                                       mlb_played_last == 2014) %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Chris") &
                                       grepl(Name, pattern = "Young") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Young" &
                                                       name_given == "Christopher Brandon") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Nelson") &
                                       grepl(Name, pattern = "Cruz") ~ CHAD_LU %>%
                                       dplyr::filter(name_given == "Nelson Ramon" &
                                                       name_last == "Cruz") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     
                                     TRUE ~ bbref_id))

Player_Value_Pitching_ALL = Player_Value_Pitching_ALL %>%
  dplyr::filter(bbref_id %notin% Player_Value_Batting_ALL$bbref_id) %>%
  dplyr::filter(bbref_id != "mcdonjo01") %>%
  dplyr::filter(bbref_id != "fieldjo04") %>%
  dplyr::mutate(bbref_id = case_when(grepl(Name, pattern = "Mike") &
                                       grepl(Name, pattern = "Adams") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Adams" &
                                                       name_given == "Jon Michael") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Rich") &
                                       grepl(Name, pattern = "Thompson") ~ CHAD_LU %>%
                                       dplyr::filter(name_last == "Thompson" &
                                                       name_given == "Richard Graeme") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Freddy") &
                                       grepl(Name, pattern = "Garcia") ~ CHAD_LU %>%
                                       dplyr::filter(Name == "Freddy Garcia" &
                                                       name_given == "Freddy Antonio") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Joe") &
                                       grepl(Name, pattern = "Kelly") ~CHAD_LU %>%
                                       dplyr::filter(name_given == "Joseph William" &
                                                       name_last == "Kelly") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Josh") &
                                       grepl(Name, pattern = "Fields") ~ CHAD_LU %>%
                                       dplyr::filter(Name == "Josh Fields" &
                                                       name_given == "Joshua David") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Joe") &
                                       grepl(Name, pattern = "Smith") ~ CHAD_LU %>%
                                       dplyr::filter(Name == "Joe Smith" &
                                                       name_given == "Joseph Michael") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Diego") &
                                       grepl(Name, pattern = "Castillo") ~ CHAD_LU %>%
                                       dplyr::filter(Name == "Diego Castillo" &
                                                       name_given == "Diego") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "Austin") &
                                       grepl(Name, pattern = "Davis") ~ CHAD_LU %>%
                                       dplyr::filter(Name == "Austin Davis" &
                                                       name_given == "Austin Richard") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     
                                     TRUE ~ bbref_id))
```

```{r scratch, eval = F, include = F, message = F, warning = F, echo = F}

str_extract(hitternames[9], pattern = "\\s+.*$") # first name
str_split_1(hitternames[9], pattern = "\\s+") # all names split
str_extract(pitchernames[11], pattern = "\\S+") # first name
str_split_1(pitchernames[11], pattern = "\\s+") # all names split

```

```{r scratch 2, eval = F, include = F, warning = F, echo = F, message = F}

## Create a function to clean the hitter dfs
clean_br_hitter_value_df_fn = function(df){
  ## Remove the "Rk" column
  df = df[ , -1 ]
  ## Remove the handedness coded into the "Name" column; first extract that info into a new column
  df = df %>%
    dplyr::mutate(Bats = case_when(grepl(Name, pattern = "\\*") ~ "L",
                                   grepl(Name, pattern = "\\#") ~ "S",
                                   TRUE ~ "R"), .after = 1) %>%
    dplyr::mutate(Name = gsub(Name, pattern = "\\*|\\#", replacement = ""))
  
  Encoding(df$Name) = "UTF-8"
  df$Name = iconv(df$Name, "UTF-8", "UTF-8", sub = " ")
  colnames(df)[25] = "Pos.Summary"
  ## Remove pitchers from the hitters df
  df = df %>%
    dplyr::mutate(idx = case_when(grepl(Pos.Summary, pattern = "1|\\/1|([0-9]-Jan)") ~ 1,
                                  TRUE ~ 0)
    ) %>%
    dplyr::filter(idx == 0)
  
  df = df %>%
    dplyr::mutate(Name = case_when(grepl(Name, pattern = "<a0>") ~ gsub(Name, pattern = "<a0>", replacement = " "),
                                   grepl(Name, pattern = "<ed>") ~ gsub(Name, pattern = "<ed>", replacement = "i"),
                                   grepl(Name, pattern = "<e1>") ~ gsub(Name, pattern = "<e1>", replacement = "a"),
                                   grepl(Name, pattern = "<fa>") ~ gsub(Name, pattern = "<fa>", replacement = "u"),
                                   grepl(Name, pattern = "<e9>") ~ gsub(Name, pattern = "<e9>", replacement = "e"),
                                   TRUE ~ Name))
  
  
  ## Convert the "salary" column
  df$Salary = as.numeric(gsub(df$Salary, pattern = "\\$|\\,", replacement = ""))/1000000
  rownames(df) = NULL
  return(df)
}

## Create functions to clean the pitcher dfs
clean_br_pitcher_value_df_fn = function(df){
  ## Remove the "Rk" column
  df = df[ , -1 ]
  ## Remove the handedness coded into the "Name" column; first extract that info into a new column
  df = df %>%
    dplyr::mutate(Throws = case_when(grepl(Name, pattern = "\\*") ~ "L",
                                     TRUE ~ "R"),
                  Name = gsub(Name, pattern = "\\*|\\#", replacement = ""))
  ## Convert to UTF-8 and remove special characters
  Encoding(df$Name) = "UTF-8"
  df$Name = iconv(df$Name, "UTF-8", "UTF-8", sub = " ")
  
  df = df %>%
    dplyr::mutate(Throws = case_when(grepl(Name, pattern = "<a0>") ~ "L",
                                     TRUE ~ "R"), .after = 1) %>%
    dplyr::mutate(Name = case_when(grepl(Name, pattern = "<a0>") ~ gsub(Name, pattern = "<a0>", replacement = " "),
                                   grepl(Name, pattern = "<ed>") ~ gsub(Name, pattern = "<ed>", replacement = "i"),
                                   grepl(Name, pattern = "<e1>") ~ gsub(Name, pattern = "<e1>", replacement = "a"),
                                   grepl(Name, pattern = "<fa>") ~ gsub(Name, pattern = "<fa>", replacement = "u"),
                                   grepl(Name, pattern = "<e9>") ~ gsub(Name, pattern = "<e9>", replacement = "e"),
                                   TRUE ~ Name))
  ## Convert the "salary" column
  df$Salary = as.numeric(gsub(df$Salary, pattern = "\\$|\\,", replacement = ""))/1000000
  rownames(df) = NULL
  return(df)
}

Player_Value_Batting_ALL = clean_br_hitter_value_df_fn(df = Player_Value_Batting_ALL)
Player_Value_Pitching_ALL = clean_br_pitcher_value_df_fn(df = Player_Value_Pitching_ALL)

  ## repeat for hitters for anything that was somehow missed
Player_Value_Batting_ALL= Player_Value_Batting_ALL %>%
  dplyr::mutate(Name = case_when(grepl(Name, pattern = "<a0>") ~ gsub(Name, pattern = "<a0>", replacement = " "),
                                 grepl(Name, pattern = "<ed>") ~ gsub(Name, pattern = "<ed>", replacement = "i"),
                                 grepl(Name, pattern = "<e1>") ~ gsub(Name, pattern = "<e1>", replacement = "a"),
                                 grepl(Name, pattern = "<fa>") ~ gsub(Name, pattern = "<fa>", replacement = "u"),
                                 grepl(Name, pattern = "<e9>") ~ gsub(Name, pattern = "<e9>", replacement = "e"),
                                 TRUE ~ Name)) %>%
  dplyr::select(-idx)
```

Find **position players** in the `Player_Value_Pitching_df` and remove them

```{r scratch 3, eval = F, include = F, warning = F, message = F, echo = F, message = F}
pitchers = unique(Player_Value_Pitching_ALL$playerid)
hitters = unique(Player_Value_Batting_ALL$playerid)

pitchers[which(pitchers %in% hitters)]
hitters[which(hitters %in% pitchers)]


## Remove hitters from the pitchers data
Player_Value_Pitching_ALL = Player_Value_Pitching_ALL %>%
  dplyr::mutate(idx = case_when(playerid %in% hitters ~ 0,
                                TRUE ~ 1)) %>%
  dplyr::filter(idx == 1) %>%
  dplyr::mutate(Name = case_when(grepl(Name, pattern = "<a0>") ~ gsub(Name, pattern = "<a0>", replacement = " "),
                                 grepl(Name, pattern = "<ed>") ~ gsub(Name, pattern = "<ed>", replacement = "i"),
                                 grepl(Name, pattern = "<e1>") ~ gsub(Name, pattern = "<e1>", replacement = "a"),
                                 grepl(Name, pattern = "<fa>") ~ gsub(Name, pattern = "<fa>", replacement = "u"),
                                 grepl(Name, pattern = "<e9>") ~ gsub(Name, pattern = "<e9>", replacement = "e"),
                                 TRUE ~ Name)) %>% 
  dplyr::select(-idx)

## find and correct pitchers names with accents
accent_names = Player_Value_Pitching_ALL %>%
  dplyr::mutate(idx = case_when(grepl(Name, pattern = "[A-Z]{1}\\s[a-z]|[a-z]{1}\\s[a-z]|\\s[A-Z]{1}\\s") ~ 0,
                                TRUE ~ 1)) %>%
  dplyr::filter(idx == 0) %>%
  dplyr::select(Name) %>%
  dplyr::distinct() %>%
  as.vector() %>%
  unlist() %>%
  as.character()

Player_Value_Pitching_ALL = Player_Value_Pitching_ALL %>%
  dplyr::mutate(Name = case_when(Name == accent_names[1] ~ "Danys Baez",
                                 Name == accent_names[2] ~ "Livan Hernandez",
                                 Name == accent_names[5] ~ "Miguel Gonzalez",
                                 Name == accent_names[6] ~ "Yoslan Herrera",
                                 Name == accent_names[7] ~ "Yoan Lopez",
                                 Name == accent_names[9] ~ "Michael Baez",
                                 Name == accent_names[10] ~ "Jose Rodriguez",
                                 Name == accent_names[12] ~ "Vladimir Gutierrez",
                                 TRUE ~ Name) )


accent_names = Player_Value_Batting_ALL %>%
  dplyr::mutate(idx = case_when(grepl(Name, pattern = "[A-Z]{1}\\s[a-z]|[a-z]{1}\\s[a-z]|\\s[A-Z]{1}\\s") ~ 0,
                                TRUE ~ 1)) %>%
  dplyr::filter(idx == 0) %>%
  dplyr::select(Name) %>%
  dplyr::distinct() %>%
  as.vector() %>%
  unlist() %>%
  as.character()

Player_Value_Batting_ALL = Player_Value_Batting_ALL %>%
  dplyr::mutate(Name = case_when(Name == accent_names[2] ~ "Alexei Ramirez",
                                 Name == accent_names[3] ~ "Dayan Vicideo",
                                 Name == accent_names[4] ~ "Yoenis Cespedes",
                                 Name == accent_names[7] ~ "Hector Olivera",
                                 Name == accent_names[8] ~ "Yasmany Tomas",
                                 Name == accent_names[9] ~ "Aledmys Diaz",
                                 Name == accent_names[10] ~ "Yandy Diaz",
                                 Name == accent_names[11] ~ "Adolis Garcia",
                                 Name == accent_names[12] ~ "Jorge Ona",
                                 TRUE ~ Name) )

```

Aggregate the player value data to obtain `Career bWAR`, `Career Salary`, and `Service time`

```{r Summarize the data, include = T, warning = F, echo = T, message = F}

CAREER_hitter_WAR_df = Player_Value_Batting_ALL %>%
  dplyr::group_by(Name, bbref_id) %>%
  dplyr::summarize(Career_bWAR = as.numeric(round(sum(as.numeric(WAR), na.rm = T), 1)),
                   Career_Sal = sum(Salary, na.rm = T),
                   Service_time = max(as.numeric(Age)) - min(as.numeric(Age)))

CAREER_pitcher_WAR_df = Player_Value_Pitching_ALL %>%
  dplyr::group_by(Name, bbref_id) %>%
  dplyr::summarize(Career_bWAR = as.numeric(round(sum(as.numeric(WAR), na.rm = T), 1)),
                   Career_Sal = sum(Salary, na.rm = T),
                   Service_time = max(as.numeric(Age)) - min(as.numeric(Age)))

CAREER_WAR_df = CAREER_hitter_WAR_df %>%
  dplyr::full_join(CAREER_pitcher_WAR_df, by = c("Name", "bbref_id", "Career_bWAR", "Career_Sal", "Service_time")) %>%
  dplyr::arrange(desc(Career_bWAR))



Hitter_year_WAR_df = Player_Value_Batting_ALL %>%
  dplyr::group_by(Name, bbref_id, Year) %>%
  dplyr::summarize(WAR = as.numeric(round(sum(as.numeric(WAR), na.rm = T), 1)),
                   Age = as.numeric(round(max(as.numeric(Age), na.rm = T))),
                   Salary = as.numeric(mean(Salary, na.rm = T))) %>%
  dplyr::ungroup() %>%
  dplyr::select(Name, bbref_id, Year, WAR, Salary, Age)

Pitcher_year_WAR_df = Player_Value_Pitching_ALL %>%
  dplyr::group_by(Name, bbref_id, Year) %>%
  dplyr::summarize(WAR = as.numeric(round(sum(as.numeric(WAR), na.rm = T), 1)),
                   Age = as.numeric(round(max(as.numeric(Age), na.rm = T))),
                   Salary = as.numeric(mean(Salary, na.rm = T)),
                   Year = max(Year, na.rm = T)) %>%
  dplyr::ungroup() %>%
  dplyr::select(Name, bbref_id, Year, WAR, Salary, Age)

PLAYER_YEAR_WAR_df = Hitter_year_WAR_df %>%
  dplyr::full_join(Pitcher_year_WAR_df, by = c("Name", "bbref_id", "Year", "WAR", "Salary", "Age")) %>%
  dplyr::arrange(desc(as.numeric(Salary)))

rm(list = ls()[which(grepl(ls(), pattern = "CAREER_hitter|CAREER_pitcher|Hitter_year|Pitcher_year"))])
```

# Baseball Reference Team Salary/Payroll data {.tabset .tabset-pills .tabset-fade}

Acquire team salary data

## Scrape and Clean Team Salary/Payroll data 

```{r Scrape team bWAR and salary/payroll data from Baseball Reference, include = T, warning = F, echo = T, message = F}
  ## Loop through the relevant years and import the tables as dataframes
for ( i in 11:21 ){
  if (i %% 10 == 0 ) {
    
      Sys.sleep(60)
    
    } else {
      
      BR_TEAM_VALUE_IMPORT_fn(Year = i, Player_data_type = "batting")
    }
}
  ## Repeat the loop for pitching stats
for ( i in 11:21 ){
  if( i %% 10 == 0 ) {
    
    Sys.sleep(60)
    
  } else {
    
    BR_TEAM_VALUE_IMPORT_fn(Year = i, Player_data_type = "pitching")
  }
}
  ## Concatenate into a aggregate dataframes by player type
TeamBatALL = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "Team_batting") == T)]), full_join)

  ## Remove the Xinn pitching column
Team_pitchingvalue_2021 = Team_pitchingvalue_2021 %>%
  dplyr::select(-RA9extras)

TeamPitALL = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "Team_pitching") == T)]), full_join)

TeamPitALL = TeamPitALL %>%
  dplyr::filter(Tm != "0" &
                  Tm != "") %>%
  dplyr::mutate(Tm = case_when(grepl(Tm, pattern = "Angels") ~ "Los Angeles Angels",
                               grepl(Tm, pattern = "Marlins") ~ "Miami Marlins",
                               grepl(Tm, pattern = "Cleveland") ~ "Cleveland Guardians",
                               TRUE ~ Tm))

## Remove league summ rows and correct team names
TeamBatALL = TeamBatALL %>%
  dplyr::filter(Tm != "0" &
                  Tm != "") %>%
  dplyr::mutate(Tm = case_when(grepl(Tm, pattern = "Angels") ~ "Los Angeles Angels",
                               grepl(Tm, pattern = "Marlins") ~ "Miami Marlins",
                               grepl(Tm, pattern = "Cleveland") ~ "Cleveland Guardians",
                               TRUE ~ Tm))
rm(list = ls()[which(grepl(ls(), pattern = "Team_") == T)])
```

## Clean Team Salary/Payroll Data

Add player acquisition data to the cleaned `Baseball Reference` player value data

+ first, identify players who changed teams

```{r Identify players who changed teams, include = T, warning = F, echo = T, message = F}

Team_Changers_hitters = Player_Value_Batting_ALL %>%
  dplyr::filter(grepl(Tm, pattern = "TM")) %>%
  dplyr::mutate(Tms = Tm) %>%
  dplyr::select(Name, lastinit, bbref_id, Year, Tms, Salary, Acquired) %>%
  dplyr::distinct()


Team_Changers_pitchers = Player_Value_Pitching_ALL %>%
  dplyr::filter(grepl(Tm, pattern = "TM")) %>%
  dplyr::mutate(Tms = Tm) %>%
  dplyr::select(Name, lastinit, bbref_id, Year, Tms, Salary, Acquired) %>%
  dplyr::distinct()
```

```{r Correct hitter positions, eval = F, include = T, message = F, warning = F, echo = F}
  ## Loop through and tab each team's number of acqusitions for the main acq. types in each year;
    ## Put them in their own dfs
      ## For hitters
Player_Value_Batting_ALL = Player_Value_Batting_ALL %>%
  dplyr::mutate(Positions = gsub(Pos.Summary, pattern = "\\*|\\/|D|H", replacement = "")) %>%
  dplyr::mutate(Positions = case_when(grepl(Positions, pattern = "\\-Mar") ~ gsub(Positions, pattern = "\\-Mar", replacement = "03"),
                                      grepl(Positions, pattern = "\\-Apr") ~ gsub(Positions, pattern = "\\-Apr", replacement = "04"),
                                      grepl(Positions, pattern = "\\-May") ~ gsub(Positions, pattern = "\\-May", replacement = "05"),
                                      grepl(Positions, pattern = "\\-Jun") ~ gsub(Positions, pattern = "\\-Jun", replacement = "06"),
                                      grepl(Positions, pattern = "\\-Jul") ~ gsub(Positions, pattern = "\\-Jul", replacement = "07"),
                                      grepl(Positions, pattern = "\\-Aug") ~ gsub(Positions, pattern = "\\-Aug", replacement = "08"),
                                      grepl(Positions, pattern = "\\-Sep") ~ gsub(Positions, pattern = "\\-Sep", replacement = "09"),
                                      Positions == "" ~ "0",
                                      TRUE ~ Positions))

batPositions = Player_Value_Batting_ALL %>%
  dplyr::select(Positions) %>%
  as.vector() %>%
  unlist() %>%
  as.character()

listy = vector()

for (i in 1:length(batPositions)) {
  listy[i] = str_extract_all(strsplit(batPositions[i], split = "\\D"), pattern = "[:digit:]")
  
  for (j in 1:length(listy[[i]])) {
    
    if (listy[[i]][j] == 0){
      listy[[i]][j] = "DH"
  }
    if (listy[[i]][j] == 2){
      listy[[i]][j] = "C"
  }
    if (listy[[i]][j] == 3){
      listy[[i]][j] = "1B"
  }
    if (listy[[i]][j] == 4){
      listy[[i]][j] = "2B"
  }
    if (listy[[i]][j] == 5){
      listy[[i]][j] = "3B"
  }
    if (listy[[i]][j] == 6){
      listy[[i]][j] = "SS"
  }
    if (listy[[i]][j] == 7){
      listy[[i]][j] = "LF"
  }
    if (listy[[i]][j] == 8){
      listy[[i]][j] = "CF"
  }
    if (listy[[i]][j] == 9){
      listy[[i]][j] = "RF"
    }
    }
  batPositions[i] = paste(unlist(listy[[i]]), collapse = " ")
}


Player_Value_Batting_ALL = Player_Value_Batting_ALL %>%
  dplyr::mutate(Positions = batPositions)
```

+ next, scrape the player's `Baseball Reference` player page to identify which teams for whom these players played

  + for hitters first
  
  + aggregate the data

```{r Scrape Individual hitters pages, include = T, message = F, warning = F, echo = T}

for (i in 1:nrow(Team_Changers_hitters)){
  if (i %% 19 == 0) {
    
    Sys.sleep(60)
    
    BR_PLAYER_CHANGER_IMPORT_fn(year = Team_Changers_hitters$Year[i],
                                lastinitial = Team_Changers_hitters$lastinit[i],
                                bbref_id = Team_Changers_hitters$bbref_id[i],
                                Player_data_type = "batting")
    
  } else {
    
    BR_PLAYER_CHANGER_IMPORT_fn(year = Team_Changers_hitters$Year[i],
                                lastinitial = Team_Changers_hitters$lastinit[i],
                                bbref_id = Team_Changers_hitters$bbref_id[i],
                                Player_data_type = "batting")
    
  }
}


Changing_hitters = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "Changer_") == T)]), full_join)
rm(list = ls()[which(grepl(ls(), pattern = "Changer_") == T)])

Team_Changers_hitters = Team_Changers_hitters %>%
  dplyr::ungroup() %>%
  left_join(Changing_hitters, by = c("lastinit", "bbref_id", "Year")) %>%
  dplyr::mutate(Tm = case_when(is.na(Tm.x) ~ Tm.y,
                               TRUE ~ Tm.x)) %>%
  dplyr::select(-Tm.x, -Tm.y) %>%
  dplyr::mutate(From = case_when(bbref_id == lead(bbref_id) ~ Tm,
                                 TRUE ~ ""),
                From = case_when(From == ""  ~ lag(From),
                                 TRUE ~ From),
                To = case_when(bbref_id == lag(bbref_id) ~ Tm,
                               TRUE ~ ""),
                To = case_when(To == "" ~ lead(To),
                               TRUE ~ To)) %>%
  dplyr::distinct() %>%
  # dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::mutate(Salary = case_when(!is.na(Salary) &
                                     Salary > 0 &
                                     grepl(Acquired, pattern = "Traded|Waivers|Amateur Draft|Free|Conditional") &
                                     Tm == From ~ -Salary,
                                   TRUE ~ Salary)) %>%
  dplyr::ungroup() %>%
  dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::select(-From, -To) %>%
  dplyr::distinct()


```

```{r repeat changing hitters I, include = T, message = F, warning = F, echo = F }
## putting the system to sleep can skip iterations
## so find those that were skipped and repeat the process above

# double check if any players were skipped; should be two more times
skipped = Team_Changers_hitters %>%
  dplyr::filter(is.na(Tm))

for (i in 1:nrow(skipped)) {
  if (nrow(skipped) > 0) {
    
    if (i %% 19 == 0) {
    
    Sys.sleep(60)
    
    BR_PLAYER_CHANGER_IMPORT_fn(year = skipped$Year[i],
                                lastinitial = skipped$lastinit[i],
                                bbref_id = skipped$bbref_id[i],
                                Player_data_type = "batting")
  
    } else {
    
    BR_PLAYER_CHANGER_IMPORT_fn(year = skipped$Year[i],
                                lastinitial = skipped$lastinit[i],
                                bbref_id = skipped$bbref_id[i],
                                Player_data_type = "batting")
    }
  }
}
    
Changing_hitters = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "Changer_") == T)]), full_join)
rm(list = ls()[which(grepl(ls(), pattern = "Changer_") == T)])

Team_Changers_hitters = Team_Changers_hitters %>%
  dplyr::ungroup() %>%
  left_join(Changing_hitters, by = c("lastinit", "bbref_id", "Year")) %>%
  dplyr::mutate(Tm = case_when(is.na(Tm.x) ~ Tm.y,
                               TRUE ~ Tm.x)) %>%
  dplyr::select(-Tm.x, -Tm.y) %>%
  dplyr::mutate(From = case_when(bbref_id == lead(bbref_id) ~ Tm,
                                 TRUE ~ ""),
                From = case_when(From == ""  ~ lag(From),
                                 TRUE ~ From),
                To = case_when(bbref_id == lag(bbref_id) ~ Tm,
                               TRUE ~ ""),
                To = case_when(To == "" ~ lead(To),
                               TRUE ~ To)) %>%
  dplyr::distinct() %>%
  # dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::mutate(Salary = case_when(!is.na(Salary) &
                                     Salary > 0 &
                                     grepl(Acquired, pattern = "Traded|Waivers|Amateur Draft|Free|Conditional") &
                                     Tm == From ~ -Salary,
                                   TRUE ~ Salary)) %>%
  dplyr::ungroup() %>%
  dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::select(-From, -To) %>%
  dplyr::distinct()
    
skipped = Team_Changers_hitters %>%
  dplyr::filter(is.na(Tm))

for (i in 1:nrow(skipped)) {
  if (nrow(skipped) > 0) {
    
    if (i %% 19 == 0) {
    
    Sys.sleep(60)
    
    BR_PLAYER_CHANGER_IMPORT_fn(year = skipped$Year[i],
                                lastinitial = skipped$lastinit[i],
                                bbref_id = skipped$bbref_id[i],
                                Player_data_type = "batting")
  
  } else {
    
    BR_PLAYER_CHANGER_IMPORT_fn(year = skipped$Year[i],
                                lastinitial = skipped$lastinit[i],
                                bbref_id = skipped$bbref_id[i],
                                Player_data_type = "batting")
    
  }
  }
}
Changing_hitters = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "Changer_") == T)]), full_join)
rm(list = ls()[which(grepl(ls(), pattern = "Changer_") == T)])

Team_Changers_hitters = Team_Changers_hitters %>%
  dplyr::ungroup() %>%
  left_join(Changing_hitters, by = c("lastinit", "bbref_id", "Year")) %>%
  dplyr::mutate(Tm = case_when(is.na(Tm.x) ~ Tm.y,
                               TRUE ~ Tm.x)) %>%
  dplyr::select(-Tm.x, -Tm.y) %>%
  dplyr::mutate(From = case_when(bbref_id == lead(bbref_id) ~ Tm,
                                 TRUE ~ ""),
                From = case_when(From == ""  ~ lag(From),
                                 TRUE ~ From),
                To = case_when(bbref_id == lag(bbref_id) ~ Tm,
                               TRUE ~ ""),
                To = case_when(To == "" ~ lead(To),
                               TRUE ~ To)) %>%
  dplyr::distinct() %>%
  # dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::mutate(Salary = case_when(!is.na(Salary) &
                                     Salary > 0 &
                                     grepl(Acquired, pattern = "Traded|Waivers|Amateur Draft|Free|Conditional") &
                                     Tm == From ~ -Salary,
                                   TRUE ~ Salary)) %>%
  dplyr::ungroup() %>%
  dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::select(-From, -To) %>%
  dplyr::distinct()

```


```{r Aggregate the hitters data who changed teams, include = F, message = F, warning = F, echo = F}
  ## join all the individual dfs
Changing_hitters = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "Changer_") == T)]), full_join)
  ## remove all the individual dfs
rm(list = ls()[which(grepl(ls(), pattern = "Changer_"))])

  ## aggregate by player-team-year to account for the salaries to team payrolls from mid-season
    ## player acquisitions
Team_Changers_hitters = Team_Changers_hitters %>%
  left_join(Changing_hitters, by = c("lastinit", "bbref_id", "Year")) %>%
  dplyr::mutate(From = case_when(bbref_id == lead(bbref_id) ~ Tm,
                                 TRUE ~ ""),
                From = case_when(From == ""  ~ lag(From),
                                 TRUE ~ From),
                To = case_when(bbref_id == lag(bbref_id) ~ Tm,
                               TRUE ~ ""),
                To = case_when(To == "" ~ lead(To),
                               TRUE ~ To)) %>%
  dplyr::select(-Tms, Tm) %>%
  dplyr::distinct() %>%
  dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::mutate(Salary = case_when(!is.na(Salary) &
                                     grepl(Acquired, pattern = "Traded|Waivers|Amateur Draft|Free Agency") &
                                     Tm == From ~ -Salary,
                                   TRUE ~ Salary)) %>%
  dplyr::ungroup() %>%
  dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::select(-From, -To) %>%
  dplyr::distinct()
```

  + repeat for pitchers
  
```{r Scrape Individual pitchers pages, include = T, message = F, warning = F, echo = T}

for (i in 1:nrow(Team_Changers_pitchers)){
  if (i %% 19 == 0) {
    
    Sys.sleep(60)
    
    BR_PLAYER_CHANGER_IMPORT_fn(year = Team_Changers_pitchers$Year[i],
                                lastinitial = Team_Changers_pitchers$lastinit[i],
                                bbref_id = Team_Changers_pitchers$bbref_id[i],
                                Player_data_type = "pitching")
    
  } else {
    
    BR_PLAYER_CHANGER_IMPORT_fn(year = Team_Changers_pitchers$Year[i],
                                lastinitial = Team_Changers_pitchers$lastinit[i],
                                bbref_id = Team_Changers_pitchers$bbref_id[i],
                                Player_data_type = "pitching")
    
  }
}

  ## join all the individual dfs
Changing_pitchers = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "Changer_") == T)]), full_join)
  ## remove all the individual dfs
rm(list = ls()[which(grepl(ls(), pattern = "Changer_"))])

  ## aggregate by player-team-year to account for the salaries to team payrolls from mid-season
    ## player acquisitions
Team_Changers_pitchers = Team_Changers_pitchers %>%
  left_join(Changing_pitchers, by = c("lastinit", "bbref_id", "Year")) %>%
  dplyr::mutate(From = case_when(bbref_id == lead(bbref_id) ~ Tm,
                                 TRUE ~ ""),
                From = case_when(From == ""  ~ lag(From),
                                 TRUE ~ From),
                To = case_when(bbref_id == lag(bbref_id) ~ Tm,
                               TRUE ~ ""),
                To = case_when(To == "" ~ lead(To),
                               TRUE ~ To)) %>%
  dplyr::select(-Tms, Tm) %>%
  dplyr::distinct() %>%
  dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::mutate(Salary = case_when(!is.na(Salary) &
                                     grepl(Acquired, pattern = "Traded|Waivers|Amateur Draft|Free Agency|Conditional") &
                                     Tm == From ~ -Salary,
                                   TRUE ~ Salary)) %>%
  dplyr::ungroup() %>%
  dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::select(-From, -To) %>%
  dplyr::distinct()




```

  + (aggregate the pitchers' data)

```{r Aggregate the pitchers data who changed teams, include = T, message = F, warning = F, echo = F}

skipped = Team_Changers_pitchers %>%
  dplyr::filter(is.na(Tm))

skipped = skipped %>%
  dplyr::mutate(bbref_id = case_when(grepl(Name, pattern = "Erik") &
                                       grepl(Name, pattern = "Johnson") ~ CHAD_LU %>%
                                       dplyr::filter(Name == "Erik Johnson" &
                                                       name_given == "Erik Craig") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     grepl(Name, pattern = "John") &
                                       grepl(Name, pattern = "Nogowski") ~ CHAD_LU %>%
                                       dplyr::filter(Name == "John Nogowski") %>%
                                       dplyr::select(key_bbref) %>%
                                       as.character(),
                                     
                                     TRUE ~ bbref_id))

for (i in 1:nrow(skipped)) {
  if (nrow(skipped) > 0) {
    
    if (i %% 19 == 0) {
    
    Sys.sleep(60)
    
    BR_PLAYER_CHANGER_IMPORT_fn(year = skipped$Year[i],
                                lastinitial = skipped$lastinit[i],
                                bbref_id = skipped$bbref_id[i],
                                Player_data_type = "pitching")
  
    } else {
    
    BR_PLAYER_CHANGER_IMPORT_fn(year = skipped$Year[i],
                                lastinitial = skipped$lastinit[i],
                                bbref_id = skipped$bbref_id[i],
                                Player_data_type = "pitching")
    }
  }
}

Changing_pitchers = purrr::reduce(mget(ls()[which(grepl(ls(), pattern = "Changer_") == T)]), full_join)
rm(list = ls()[which(grepl(ls(), pattern = "Changer_") == T)])

Team_Changers_pitchers = Team_Changers_pitchers %>%
  dplyr::ungroup() %>%
  left_join(Changing_hitters, by = c("lastinit", "bbref_id", "Year")) %>%
  dplyr::mutate(Tm = case_when(is.na(Tm.x) ~ Tm.y,
                               TRUE ~ Tm.x)) %>%
  dplyr::select(-Tm.x, -Tm.y) %>%
  dplyr::mutate(From = case_when(bbref_id == lead(bbref_id) ~ Tm,
                                 TRUE ~ ""),
                From = case_when(From == ""  ~ lag(From),
                                 TRUE ~ From),
                To = case_when(bbref_id == lag(bbref_id) ~ Tm,
                               TRUE ~ ""),
                To = case_when(To == "" ~ lead(To),
                               TRUE ~ To)) %>%
  dplyr::distinct() %>%
  # dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::mutate(Salary = case_when(!is.na(Salary) &
                                     Salary > 0 &
                                     grepl(Acquired, pattern = "Traded|Waivers|Amateur Draft|Free|Conditional") &
                                     Tm == From ~ -Salary,
                                   TRUE ~ Salary)) %>%
  dplyr::ungroup() %>%
  dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::select(-From, -To) %>%
  dplyr::distinct()

  ## aggregate by player-team-year to account for the salaries to team payrolls from mid-season
    ## player acquisitions
Team_Changers_pitchers = Team_Changers_pitchers %>%
  left_join(Changing_pitchers, by = c("lastinit", "bbref_id", "Year")) %>%
  dplyr::mutate(From = case_when(bbref_id == lead(bbref_id) ~ Tm,
                                 TRUE ~ ""),
                From = case_when(From == ""  ~ lag(From),
                                 TRUE ~ From),
                To = case_when(bbref_id == lag(bbref_id) ~ Tm,
                               TRUE ~ ""),
                To = case_when(To == "" ~ lead(To),
                               TRUE ~ To)) %>%
  dplyr::select(-Tms, Tm) %>%
  dplyr::distinct() %>%
  dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::mutate(Salary = case_when(!is.na(Salary) &
                                     grepl(Acquired, pattern = "Traded|Waivers|Amateur Draft|Free Agency") &
                                     Tm == From ~ -Salary,
                                   TRUE ~ Salary)) %>%
  dplyr::ungroup() %>%
  dplyr::group_by(bbref_id, Year, Tm) %>%
  dplyr::select(-From, -To) %>%
  dplyr::distinct()
```

+ aggregate all the changers' data

+ a negative salary change equates to dumping payroll; positive equates to adding payroll

```{r Combine the changers data, include = T, message = F, warning = F, echo = T}
  ## join all hitters and pitchers who changed teams
Team_Changers_ALL = Team_Changers_hitters %>%
  full_join(Team_Changers_pitchers)

Team_Changers_ALL %>%
  dplyr::filter(is.na(Tm))

    ## adjust each team's payroll for the players they acquired or traded away
      ## - Salary adjustment = gaining space (salary dumping)
Team_Changers_ALL %>%
  dplyr::group_by(Tm, Year) %>%
  dplyr::summarize(Sum_Num_Trades = sum(case_when(Acquired == "Traded" ~ 1,
                                                  Acquired == "Amateur Draft" ~ 1,
                                                  Acquired == "Conditional Deal" ~ 1,
                                                  TRUE ~ 0), na.rm = T),
                   Sum_Num_FAs = sum(case_when(Acquired == "Free Agency" ~ 1,
                                               Acquired == "Amateur Free Agent" ~ 1,
                                               TRUE ~ 0), na.rm = T),
                   Sum_Num_Claims = sum(case_when(Acquired == "Waivers" ~ 1,
                                                  TRUE ~ 0), na.rm = T),
                   Sum_Sal_Change = sum(Salary, na.rm = T)) %>%
  dplyr::arrange(Sum_Sal_Change)
Player_Value_Batting_ALL %>%
  dplyr::group_by(Tm) %>%
  


  cleaned_br_hitter_val_df_list[[i]][-which(cleaned_br_hitter_val_df_list[[i]]$Tm == "2TM" |
                                                   cleaned_br_hitter_val_df_list[[i]]$Tm == "3TM" |
                                                   cleaned_br_hitter_val_df_list[[i]]$Tm == "4TM" |
                                                   cleaned_br_hitter_val_df_list[[i]]$Tm == "5TM"),
  ] %>%
    group_by(Tm, Year) %>%
    summarise(Sum_Num_Trades = sum(length(which(Acquired == "Traded"))),
              Sum_Num_FAs = sum(length(which(Acquired == "Free Agency"))),
              Sum_Num_Ams = sum(length(which(Acquired == "Amateur Draft" | Acquired == "Amateur Free Agent"))),
              Sum_Sal = sum(Salary, na.rm = T)) %>%
    arrange(Tm) %>%
    as.data.frame()
  assign(paste("HitterAcqs_", i, sep = ""), df, .GlobalEnv)
}

```

Repeat for pitchers

```{r Add player acquisition data to the Baseball Reference player value data pt.2, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
df = vector()
for(i in 1:11){
  df = cleaned_br_pitcher_val_df_list[[i]][-which(cleaned_br_pitcher_val_df_list[[i]]$Tm == "2TM" |
                                                    cleaned_br_pitcher_val_df_list[[i]]$Tm == "3TM" | 
                                                    cleaned_br_pitcher_val_df_list[[i]]$Tm == "4TM" |
                                                    cleaned_br_pitcher_val_df_list[[i]]$Tm == "5TM"),] %>%
    group_by(Tm, Year) %>%
    summarise(Sum_Num_Trades = sum(length(which(Acquired == "Traded"))),
              Sum_Num_FAs = sum(length(which(Acquired == "Free Agency"))),
              Sum_Num_Ams = sum(length(which(Acquired == "Amateur Draft" | Acquired == "Amateur Free Agent"))),
              Sum_Sal = sum(Salary, na.rm = T)) %>%
    arrange(Tm) %>%
    as.data.frame()
  assign(paste("PitcherAcqs_", i, sep = ""), df, .GlobalEnv)
}
```

Concatenate the acquisition dfs into a list of dfs; prep the data to be joined to the `TeamBatALL`, `TeamPitALL` dfs

```{r Prep Baseball Reference value data pt.1, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Concatenate into a list of dfs
HitterAcqs = mget(
  unlist(
    ls()[
      which(grepl(ls(), pattern = "HitterAcqs_") == TRUE)
    ][c(1,4:11,2,3)]
  )
)
PitcherAcqs = mget(
  unlist(
    ls()[
      which(grepl(ls(), pattern = "PitcherAcqs_") == TRUE)
    ][c(1,4:11,2,3)]
  )
)
  ## Remove the individual dfs
rm(list = 
     ls()[grep(ls()[], pattern = "HitterAcqs_|PitcherAcqs_")]
)
  ## Re-name the Marlins
PitcherAcqs[[1]]$Tm[which(PitcherAcqs[[1]]$Tm == "FLA")] = "MIA"
HitterAcqs[[1]]$Tm[which(HitterAcqs[[1]]$Tm == "FLA")] = "MIA"
  ## Re-order the list of dfs alphabetically
PitcherAcqs[[1]] = PitcherAcqs[[1]][order(PitcherAcqs[[1]]$Tm),]
HitterAcqs[[1]] = HitterAcqs[[1]][order(HitterAcqs[[1]]$Tm),]
  ## Match names with full official names
for(i in 1:11){
  PitcherAcqs[[i]]$Tm = unique(sort(StandALL$Tm))
  HitterAcqs[[i]]$Tm = unique(sort(StandALL$Tm))
}
  ## Re-arrange dfs into one df, housing the acq. data
PitcherAcqs = bind_rows(PitcherAcqs, .id = "column_label")
PitcherAcqs = PitcherAcqs %>%
  select(Tm, Year, Sum_Num_Trades, Sum_Num_FAs, Sum_Num_Ams, Sum_Sal)

HitterAcqs = bind_rows(HitterAcqs, .id = "column_label")
HitterAcqs = HitterAcqs %>%
  select(Tm, Year, Sum_Num_Trades, Sum_Num_FAs, Sum_Num_Ams, Sum_Sal)

  ## Join with Team Value data and remove extra data
TeamBatALL = HitterAcqs %>%
  left_join(TeamBatALL) %>%
  select(Tm, Year, Sum_Num_Trades, Sum_Num_FAs, Sum_Num_Ams, Sum_Sal, WAR, Salary)
TeamPitALL = PitcherAcqs %>%
  left_join(TeamPitALL) %>%
  select(Tm, Year, Sum_Num_Trades, Sum_Num_FAs, Sum_Num_Ams, Sum_Sal, WAR, Salary)
```

Combine into one `TeamValALL` df

```{r Prep Baseball Reference value data pt.2, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Combine team pitching and team hitting WAR, salary
TeamValALL = TeamBatALL
TeamValALL[,c(3:8)] = TeamBatALL[,c(3:8)] + TeamPitALL[,c(3:8)]

TeamValALL = StandALL %>%
  inner_join(TeamValALL)
colnames(TeamValALL)[4] = "W_L"

  ## Remove temp dfs
rm(Team_battingvalue_2011, Team_battingvalue_2012, Team_battingvalue_2013, Team_battingvalue_2014, Team_battingvalue_2015, Team_battingvalue_2016, Team_battingvalue_2017, Team_battingvalue_2018, Team_battingvalue_2019, Team_battingvalue_2020, Team_battingvalue_2021)
rm(Team_pitchingvalue_2011, Team_pitchingvalue_2012, Team_pitchingvalue_2013, Team_pitchingvalue_2014, Team_pitchingvalue_2015, Team_pitchingvalue_2016, Team_pitchingvalue_2017, Team_pitchingvalue_2018, Team_pitchingvalue_2019, Team_pitchingvalue_2020, Team_pitchingvalue_2021)

head(TeamValALL)
```



Small function to analyze college draft selections

```{r Write a small function that analyzes draft selections, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}

  ## Create a function that analyzes the number of college picks by position of a given team in a given year
Draft_df_Analysis = function(df, Team){
  
  ## Loop through and determine how many of which position a given team drafted in a given draft; how many of all were college picks
  for(i in levels(as.factor(df$POS[which(df$Tm == Team)]))){
    print(
      paste(
        sum(str_count(df$POS[which(df$Tm == Team)], i)),
        i,
        ";",
        length(which(grepl(df$`Drafted From`[ which(df$Tm == Team)],
                           pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech") == TRUE)),
        "/",
        length(which(df$Tm == Team) == TRUE),
        "College Picks")
    )
  }
}
  ## Note that there may be duplicates in some dfs; better to perform analysis after duplicates are removed
Draft_df_Analysis(df = BBA_DRAFT_ALL, Team = "New York Yankees")
```


Check the details on the Astros' and Cubs' First 5 Rd selections from 2011-2021

```{r Scrape and clean amateur draft data from Baseball Almanac pt.2, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
print(BBA_DRAFT_ALL %>%
        dplyr::filter(Tm == "Houston Astros") %>%
        dplyr::filter(Rd <= 5), n = 59 )
      
      
print(BBA_DRAFT_ALL %>%
        dplyr::filter(Tm == "Chicago Cubs") %>%
        dplyr::filter(Rd <= 5), n = 58)
```







## Scrape MLB Free-Agent Data from ESPN

```{r Scrape and clean Free-Agent data from ESPN, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
## Create a function to scrape Free-Agent Data from ESPN
ESPN_FA_import_fn = function(Year, selector){
  df = read_html(
    paste("https://www.espn.com/mlb/freeagents/_/year/20", Year, "/type/signed", sep = "")
  ) %>%
    html_element(css = selector) %>%
    html_table()
  df = as.data.frame(df)
  df = df[ -c(1,nrow(df)), -c(4,5,8)]
  df = df[ -which(df$X1 == "PLAYER"), ]
    ## Duplicate the total value column
  df$TotalValue = df$X9
    ## Add a column of character values, describing whether the contract was a minors contract
  df$Type = ""
    ## Fill values of Minor Lg contracts with "MiLB" string
  if ( length(
    which(grepl(df$X9, pattern = "Minor Lg") == TRUE)
  ) > 0){
    df$Type[ which(grepl(df$X9, pattern = "Minor Lg") == TRUE) ] = "MiLB"
  } 
  if ( length(
    which(grepl(df$X9, pattern = "--") == TRUE) 
  ) > 0 ){
    df$Type[ which(grepl(df$X9, pattern = "--") == TRUE) ] = "Undisclosed"
  }
  df$Type[ which(grepl(df$X9, pattern = "\\,") == TRUE) ] = "MLB"
  
    ## Change undisclosed contract values to 0
  df$X9[ which(grepl(df$X9, pattern = "--") == TRUE) ] = 0
    ## Change minor league deal values to 0
  df$X9[ which(grepl(df$X9, pattern = "Minor Lg") == TRUE) ] = 0
  
    ## Change undisclosed contract values to 0
  df$TotalValue[ which(grepl(df$TotalValue, pattern = "--") == TRUE) ] = 0
    ## Change minor league deal values to 0
  df$TotalValue[ which(grepl(df$TotalValue, pattern = "Minor Lg") == TRUE) ] = 0
    ## Remove dollar signs and commas from value; replace ,s and divide by 1M to display values in terms of millions of dollars
  df$X9 = gsub(df$X9, pattern = "\\$", replacement = "")
  df$X9 = gsub(df$X9, pattern = "\\,", replacement = "")
  df$TotalValue = gsub(df$TotalValue, pattern = "\\$", replacement = "")
  df$TotalValue = gsub(df$TotalValue, pattern = "\\,", replacement = "")
  df$TotalValue = as.numeric(df$TotalValue) / 1000000 ## Data is in Millions of USD
  df$X9 = (as.numeric(df$X9) / as.numeric(df$X7)) / 1000000
  df = add_column(df, Year = "", .before = 2)
  df[,2] = as.numeric(paste("20", Year, sep = ""))
  colnames(df)[c(1,3:7)] = c("Name", "Position", "Age", "Team", "Years", "AAV")
  
  df$Age = as.numeric(df$Age) - (2021 - as.numeric(df$Year) )
  
  for (i in 11:21){
    if ( df$Year == as.numeric(
      paste("20", i, sep = "") )
    ) {
      
    }
  }
  
  assign(paste("ESPN_FA_20", Year, sep = ""), df, envir = .GlobalEnv)
  return(df)
  
}
  ## Create a variable for a selector
ESPN_selector = "#my-players-table"
  ## Loop through and import the data for the relevant time-frame
for ( i in 11:21 ) {
  ESPN_FA_import_fn(Year = i, selector = ESPN_selector)
}
  ## Combine the dfs into one df
ESPN = bind_rows(ESPN_FA_2011, ESPN_FA_2012, ESPN_FA_2013, ESPN_FA_2014, ESPN_FA_2015,
                 ESPN_FA_2016, ESPN_FA_2017, ESPN_FA_2018, ESPN_FA_2019, ESPN_FA_2020,
                 ESPN_FA_2021)
  ## Remove FA deals to Japanese baseball league and "undisclosed" deals
ESPN = ESPN[ -which(ESPN$Team == "Japan"), ]
ESPN = ESPN[ -which(ESPN$Type == "Undisclosed"), ]
rm(ESPN_FA_2011, ESPN_FA_2012, ESPN_FA_2013, ESPN_FA_2014, ESPN_FA_2015, ESPN_FA_2016, ESPN_FA_2017, ESPN_FA_2018, ESPN_FA_2019, ESPN_FA_2020, ESPN_FA_2021)
```

## Scrape and Clean International Signing Data from Spotrac

```{r Scrape and clean Intl Signing Data from Spotrac, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Create a selector from the spotrac website
spotrac_Intl_selector = "#main > div > div.teams > table"
  ## Create a function that will scrape International Signing Data from Spotrac and clean the dataframe
Spotrac_Intl_import_fn = function(Year, spotrac_selector){
  df = read_html(
    paste("https://www.spotrac.com/mlb/international/20", Year, "/", sep = "")
  ) %>% 
    html_element(css = spotrac_selector) %>%
    html_table()
  df = as.data.frame(df)
  colnames(df) = c("Player", "Pos", "Country", "Team", "Bonus")
  df$Bonus = as.numeric(gsub(df$Bonus, pattern = "\\$|\\,", replacement = ""))/1000000
  df$Year = as.numeric(paste("20", Year, sep = ""))
  assign(paste("Intl_Signings_20", Year, sep = ""), df, envir = .GlobalEnv)
}
  ## Loop through the scraping function by the relevant years
for ( i in 11:21 ) {
  Spotrac_Intl_import_fn(Year = i, spotrac_selector = spotrac_Intl_selector)
}
  ## Put all the dfs into one df and remove the separate dfs
IntlALL = rbind.data.frame(Intl_Signings_2011, Intl_Signings_2012, Intl_Signings_2013, Intl_Signings_2014, Intl_Signings_2015,
                           Intl_Signings_2016, Intl_Signings_2017, Intl_Signings_2018, Intl_Signings_2019, Intl_Signings_2020,
                           Intl_Signings_2021)
rm(Intl_Signings_2011, Intl_Signings_2012, Intl_Signings_2013, Intl_Signings_2014, Intl_Signings_2015, Intl_Signings_2016, Intl_Signings_2017, Intl_Signings_2018, Intl_Signings_2019, Intl_Signings_2020, Intl_Signings_2021)
```

## Create and Populate DFs for Plotting

Create dfs

```{r Subsetting Astros and Cubs dfs for plotting, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Remove "Carlos Pena" from Chicago Cubs draft records
BBA_DRAFT_ALL = BBA_DRAFT_ALL[ -which(BBA_DRAFT_ALL$Name == "Carlos Pena"), ]

  ## Remove duplicates
BBA_DRAFT_ALL_no_dup = BBA_DRAFT_ALL[ -which(duplicated(BBA_DRAFT_ALL$Name) == TRUE), ]

  ## Correct Lance McCullers' name
BBA_DRAFT_ALL$Name[ grep(BBA_DRAFT_ALL$Name, pattern = "McCullers") ] = "Lance McCullers Jr."
BBA_DRAFT_ALL_no_dup$Name[ grep(BBA_DRAFT_ALL_no_dup$Name, pattern = "McCullers") ] = "Lance McCullers Jr."

  ## Subset the relevant draft data
ASTROS_CUBS_DRAFT_SUB =
  BBA_DRAFT_ALL_no_dup[ which(BBA_DRAFT_ALL_no_dup$Tm == "Houston Astros" |
                                BBA_DRAFT_ALL_no_dup$Tm == "Chicago Cubs") , ]

LEAGUE_DRAFT_SUB = BBA_DRAFT_ALL_no_dup[ which(BBA_DRAFT_ALL_no_dup$Tm != "Houston Astros" &
                                                 BBA_DRAFT_ALL_no_dup$Tm != "Chicago Cubs"), ]

  ## Join draft subset dfs with career WAR data -> How good drafting was
ASTROS_CUBS_DRAFT_SUB = ASTROS_CUBS_DRAFT_SUB %>%
  left_join(PLAYER_CAREER_WAR)
ASTROS_CUBS_DRAFT_SUB[ -which(ASTROS_CUBS_DRAFT_SUB$Year == 2011), ] %>%
  group_by(Tm) %>%
  summarize(Career_WAR = sum(`Career WAR`, na.rm = T)) %>%
  arrange(desc(Career_WAR))

LEAGUE_DRAFT_SUB = LEAGUE_DRAFT_SUB %>%
  left_join(PLAYER_CAREER_WAR)
Draft_Results = LEAGUE_DRAFT_SUB %>%
  group_by(Tm, Year) %>%
  summarize(Career_WAR = sum(`Career WAR`, na.rm = T)) %>%
  arrange(desc(Career_WAR))

  ## Create subset dfs of standings, value, international signing and free-agent data for the rest of the league
LEAGUE_STAND_SUB = StandALL[ which(StandALL$Tm != "Houston Astros" & StandALL$Tm != "Chicago Cubs"), ]
LEAGUE_VAL_SUB = TeamValALL[ which(TeamValALL$Tm != "Houston Astros" & TeamValALL$Tm != "Chicago Cubs"), ]
LEAGUE_INTL_SUB = IntlALL[ which(IntlALL$Team != "HOU" & IntlALL$Team != "CHC"), ]
LEAGUE_ESPN_SUB = ESPN[ which(ESPN$Team != "Astros" & ESPN$Team != "Cubs"), ]
```

Populate Astros, Cubs, and League "Tanking" dfs

```{r TANK DF filling pt.1, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Create separate dfs for the Cubs and Astros
ASTROS_TANK_DF = matrix(ncol = 18, nrow = length(seq(2011,2021)))
CUBS_TANK_DF = matrix(ncol = 18, nrow = length(seq(2011,2021)))

ASTROS_TANK_DF = as.data.frame(ASTROS_TANK_DF)
CUBS_TANK_DF = as.data.frame(CUBS_TANK_DF)

  ## Create column names
colnames(ASTROS_TANK_DF) = c("Year", "Win%", "# Top 5 picks", "# SS Drafted", "# P Drafted",
                             "# College Draftees", "# Draft Picks", "SS %", "P %", "College %",
                             "# Int'l Signings", "Int'l Signing Money Spent", "# FA Contracts",
                             "Mean FA AAV", "Mean FA Length", "Mean FA Total Value", "Team bWAR",
                             "Team payroll")

colnames(CUBS_TANK_DF) = colnames(ASTROS_TANK_DF)
  ## Create a df for lg avg stats to merge
LG_TANK_DF = matrix(nrow = nrow(ASTROS_TANK_DF), ncol = ncol(ASTROS_TANK_DF))
LG_TANK_DF = as.data.frame(LG_TANK_DF)
colnames(LG_TANK_DF) = colnames(ASTROS_TANK_DF)

  ## Add years
for(i in 1:nrow(ASTROS_TANK_DF)){
  ASTROS_TANK_DF[i,1] = seq(2011,2021)[i]
  CUBS_TANK_DF[i,1] = seq(2011,2021)[i]
  LG_TANK_DF[i,1] = seq(2011,2021)[i]
}

  ## Fill Win %
ASTROS_TANK_DF[,2] = StandALL$`W-L%`[ which(StandALL$Tm == "Houston Astros") ]
CUBS_TANK_DF[,2] = StandALL$`W-L%`[ which(StandALL$Tm == "Chicago Cubs") ]
LG_TANK_DF$`Win%` = 0.500
```

Fill # of picks in First 5 rds

```{r TANK DF filling draft picks 1, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Fill # of Picks in First 5 rds
ASTROS_TANK_DF[1,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" &
                                       ASTROS_CUBS_DRAFT_SUB$Year == 2011 &
                                       ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
```

Repeat for rest, for `CUBS_TANK_DF` and `LG_TANK_DF` (not shown)

```{r TANK DF filling draft picks 2, include = TRUE, warning = FALSE, echo = FALSE, message = FALSE}
ASTROS_TANK_DF[2,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[3,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[4,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[5,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[6,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[7,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[8,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[9,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[10,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[11,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )

CUBS_TANK_DF[1,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[2,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[3,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[4,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[5,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[6,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[7,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[8,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[9,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[10,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[11,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )

LG_TANK_DF[1,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2011 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[2,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2012 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[3,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2013 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[4,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2014 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[5,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2015 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[6,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2016 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[7,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2017 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[8,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2018 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[9,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2019 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[10,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2020 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[11,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2021 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
```
Fill # SSs drafted

```{r TANK DF filling SSs 1, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
## Fill # of SSs drafted
ASTROS_TANK_DF[1,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" &
                                       ASTROS_CUBS_DRAFT_SUB$Year == 2011 &
                                       ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
```

Repeat for rest, for `CUBS_TANK_DF` and `LG_TANK_DF` (not shown)

```{r TANK DF filling SSs 2, include = TRUE, warning = FALSE, echo = FALSE, message = FALSE}
ASTROS_TANK_DF[2,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[3,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[4,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[5,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[6,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[7,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[8,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[9,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[10,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[11,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )

CUBS_TANK_DF[1,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[2,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[3,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[4,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[5,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[6,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[7,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[8,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[9,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[10,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[11,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )

LG_TANK_DF[1,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2011 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[2,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2012 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[3,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2013 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[4,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2014 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[5,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2015 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[6,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2016 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[7,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2017 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[8,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2018 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[9,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2019 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[10,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2020 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[11,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2021 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
```

Populate the rest of the dfs (not shown)

```{r TANK DF filling, include = TRUE, warning = FALSE, echo = FALSE, message = FALSE}
## Fill # of Ps drafted
ASTROS_TANK_DF[1,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[2,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[3,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[4,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[5,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[6,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[7,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2017)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2017)], pattern = "RHP|LHP")] )
ASTROS_TANK_DF[8,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2018)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2018)], pattern = "RHP|LHP")] )
ASTROS_TANK_DF[9,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2019)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2019)], pattern = "RHP|LHP")] )
ASTROS_TANK_DF[10,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2020)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2020)], pattern = "RHP|LHP")] )
ASTROS_TANK_DF[11,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2021)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2021)], pattern = "RHP|LHP")] )

CUBS_TANK_DF[1,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[2,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[3,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[4,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[5,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[6,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[7,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2017)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2017)], pattern = "RHP|LHP")] )
CUBS_TANK_DF[8,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2018)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2018)], pattern = "RHP|LHP")] )
CUBS_TANK_DF[9,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2019)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2019)], pattern = "RHP|LHP")] )
CUBS_TANK_DF[10,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2020)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2020)], pattern = "RHP|LHP")] )
CUBS_TANK_DF[11,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2021)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2021)], pattern = "RHP|LHP")] )

LG_TANK_DF[1,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2011 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[2,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2012 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[3,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2013 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[4,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2014 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[5,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2015 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[6,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2016 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[7,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2017 & LEAGUE_DRAFT_SUB$POS == "P")[grep(LEAGUE_DRAFT_SUB$POS[which( LEAGUE_DRAFT_SUB$Year== 2017)], pattern = "RHP|LHP")] ) / 28, digits = 2)
LG_TANK_DF[8,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2018 & LEAGUE_DRAFT_SUB$POS == "P")[grep(LEAGUE_DRAFT_SUB$POS[which( LEAGUE_DRAFT_SUB$Year== 2018)], pattern = "RHP|LHP")] ) / 28, digits = 2)
LG_TANK_DF[9,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2019 & LEAGUE_DRAFT_SUB$POS == "P")[grep(LEAGUE_DRAFT_SUB$POS[which( LEAGUE_DRAFT_SUB$Year== 2019)], pattern = "RHP|LHP")] ) / 28, digits = 2)
LG_TANK_DF[10,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2020 & LEAGUE_DRAFT_SUB$POS == "P")[grep(LEAGUE_DRAFT_SUB$POS[which( LEAGUE_DRAFT_SUB$Year== 2020)], pattern = "RHP|LHP")] ) / 28, digits = 2)
LG_TANK_DF[11,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2021 & LEAGUE_DRAFT_SUB$POS == "P")[grep(LEAGUE_DRAFT_SUB$POS[which( LEAGUE_DRAFT_SUB$Year== 2021)], pattern = "RHP|LHP")] ) / 28, digits = 2)

## Fill # of College Picks
ASTROS_TANK_DF[1,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2011 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[2,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2012 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[3,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2013 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[4,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2014 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[5,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2015 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[6,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2016 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[7,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2017 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[8,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2018 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[9,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2019 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[10,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2020 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[11,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2021 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))

CUBS_TANK_DF[1,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2011 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[2,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2012 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[3,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2013 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[4,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2014 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[5,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2015 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[6,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2016 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[7,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2017 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[8,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2018 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[9,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2019 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[10,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2020 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[11,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2021 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))

LG_TANK_DF[1,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2011 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[2,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2012 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[3,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2013 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[4,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2014 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[5,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2015 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[6,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2016 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[7,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2017 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[8,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2018 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[9,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2019 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[10,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2020 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[11,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2021 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)

## Fill Total # Picks
ASTROS_TANK_DF[1,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[2,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[3,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[4,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[5,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[6,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[7,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[8,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[9,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[10,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[11,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))

CUBS_TANK_DF[1,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[2,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[3,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[4,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[5,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[6,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[7,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[8,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[9,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[10,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[11,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))

LG_TANK_DF[1,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2011)) / 28, digits = 2)
LG_TANK_DF[2,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2012)) / 28, digits = 2)
LG_TANK_DF[3,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2013)) / 28, digits = 2)
LG_TANK_DF[4,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2014)) / 28, digits = 2)
LG_TANK_DF[5,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2015)) / 28, digits = 2)
LG_TANK_DF[6,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2016)) / 28, digits = 2)
LG_TANK_DF[7,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2017)) / 28, digits = 2)
LG_TANK_DF[8,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2018)) / 28, digits = 2)
LG_TANK_DF[9,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2019)) / 28, digits = 2)
LG_TANK_DF[10,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2020)) / 28, digits = 2)
LG_TANK_DF[11,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2021)) / 28, digits = 2)

## Fill % of picks on SSs
ASTROS_TANK_DF[,8] = round((ASTROS_TANK_DF[,4] / ASTROS_TANK_DF[,7])*100, digits = 2)
CUBS_TANK_DF[,8] = round((CUBS_TANK_DF[,4] / CUBS_TANK_DF[,7])*100, digits = 2)
LG_TANK_DF[,8] = round((LG_TANK_DF[,4] / LG_TANK_DF[,7])*100, digits = 2)
## Fill % of picks on Ps
ASTROS_TANK_DF[,9] = round((ASTROS_TANK_DF[,5] / ASTROS_TANK_DF[,7])*100, digits = 2)
CUBS_TANK_DF[,9] = round((CUBS_TANK_DF[,5] / CUBS_TANK_DF[,7])*100, digits = 2)
LG_TANK_DF[,9] = round((LG_TANK_DF[,5] / LG_TANK_DF[,7])*100, digits = 2)
## Fill % of picks on college players
ASTROS_TANK_DF[,10] = round((ASTROS_TANK_DF[,6] / ASTROS_TANK_DF[,7])*100, digits = 2)
CUBS_TANK_DF[,10] = round((CUBS_TANK_DF[,6] / CUBS_TANK_DF[,7])*100, digits = 2)
LG_TANK_DF[,10] = round((LG_TANK_DF[,6] / LG_TANK_DF[,7])*100, digits = 2)

## How many Int'l FAs
ASTROS_TANK_DF[1,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2011))
ASTROS_TANK_DF[2,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2012))
ASTROS_TANK_DF[3,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2013))
ASTROS_TANK_DF[4,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2014))
ASTROS_TANK_DF[5,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2015))
ASTROS_TANK_DF[6,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2016))
ASTROS_TANK_DF[7,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2017))
ASTROS_TANK_DF[8,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2018))
ASTROS_TANK_DF[9,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2019))
ASTROS_TANK_DF[10,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2020))
ASTROS_TANK_DF[11,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2021))

CUBS_TANK_DF[1,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2011))
CUBS_TANK_DF[2,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2012))
CUBS_TANK_DF[3,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2013))
CUBS_TANK_DF[4,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2014))
CUBS_TANK_DF[5,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2015))
CUBS_TANK_DF[6,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2016))
CUBS_TANK_DF[7,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2017))
CUBS_TANK_DF[8,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2018))
CUBS_TANK_DF[9,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2019))
CUBS_TANK_DF[10,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2020))
CUBS_TANK_DF[11,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2021))

LG_TANK_DF[1,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2011))/ 28, digits = 2)
LG_TANK_DF[2,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2012))/ 28, digits = 2)
LG_TANK_DF[3,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2013))/ 28, digits = 2)
LG_TANK_DF[4,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2014))/ 28, digits = 2)
LG_TANK_DF[5,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2015))/ 28, digits = 2)
LG_TANK_DF[6,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2016))/ 28, digits = 2)
LG_TANK_DF[7,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2017))/ 28, digits = 2)
LG_TANK_DF[8,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2018))/ 28, digits = 2)
LG_TANK_DF[9,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2019))/ 28, digits = 2)
LG_TANK_DF[10,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2020))/ 28, digits = 2)
LG_TANK_DF[11,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2021))/ 28, digits = 2)

## Total Spent on Int'l FAs
ASTROS_TANK_DF[1,12] = 0#sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2011)])
ASTROS_TANK_DF[2,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2012)], na.rm = T)
ASTROS_TANK_DF[3,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2013)], na.rm = T)
ASTROS_TANK_DF[4,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2014)], na.rm = T)
ASTROS_TANK_DF[5,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2015)], na.rm = T)
ASTROS_TANK_DF[6,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2016)], na.rm = T)
ASTROS_TANK_DF[7,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2017)], na.rm = T)
ASTROS_TANK_DF[8,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2018)], na.rm = T)
ASTROS_TANK_DF[9,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2019)], na.rm = T)
ASTROS_TANK_DF[10,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2020)], na.rm = T)
ASTROS_TANK_DF[11,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2021)], na.rm = T)

CUBS_TANK_DF[1,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2011)], na.rm = T)
CUBS_TANK_DF[2,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2012)], na.rm = T)
CUBS_TANK_DF[3,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2013)], na.rm = T)
CUBS_TANK_DF[4,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2014)], na.rm = T)
CUBS_TANK_DF[5,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2015)], na.rm = T)
CUBS_TANK_DF[6,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2016)], na.rm = T)
CUBS_TANK_DF[7,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2017)], na.rm = T)
CUBS_TANK_DF[8,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2018)], na.rm = T)
CUBS_TANK_DF[9,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2019)], na.rm = T)
CUBS_TANK_DF[10,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2020)], na.rm = T)
CUBS_TANK_DF[11,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2021)], na.rm = T)

LG_TANK_DF[1,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2011)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[2,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2012)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[3,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2013)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[4,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2014)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[5,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2015)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[6,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2016)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[7,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2017)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[8,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2018)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[9,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2019)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[10,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2020)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[11,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2021)], na.rm = T) / 28, digits = 3)

## Fill FA signing data
## Number of contracts
ASTROS_TANK_DF[1,13] = length(which(ESPN$Year == 2011 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[2,13] = length(which(ESPN$Year == 2012 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[3,13] = length(which(ESPN$Year == 2013 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[4,13] = length(which(ESPN$Year == 2014 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[5,13] = length(which(ESPN$Year == 2015 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[6,13] = length(which(ESPN$Year == 2016 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[7,13] = length(which(ESPN$Year == 2017 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[8,13] = length(which(ESPN$Year == 2018 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[9,13] = length(which(ESPN$Year == 2019 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[10,13] = length(which(ESPN$Year == 2020 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[11,13] = length(which(ESPN$Year == 2021 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))

CUBS_TANK_DF[1,13] = length(which(ESPN$Year == 2011 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[2,13] = length(which(ESPN$Year == 2012 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[3,13] = length(which(ESPN$Year == 2013 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[4,13] = length(which(ESPN$Year == 2014 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[5,13] = length(which(ESPN$Year == 2015 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[6,13] = length(which(ESPN$Year == 2016 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[7,13] = length(which(ESPN$Year == 2017 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[8,13] = length(which(ESPN$Year == 2018 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[9,13] = length(which(ESPN$Year == 2019 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[10,13] = length(which(ESPN$Year == 2020 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[11,13] = length(which(ESPN$Year == 2021 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))

LG_TANK_DF[1,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2011 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[2,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2012 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[3,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2013 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[4,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2014 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[5,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2015 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[6,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2016 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[7,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2017 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[8,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2018 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[9,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2019 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[10,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2020 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[11,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2021 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)

## Mean AAV of FA contracts
ASTROS_TANK_DF[1,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2011 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[2,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2012 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[3,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2013 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[4,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2014 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[5,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2015 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[6,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2016 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[7,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2017 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[8,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2018 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[9,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2019 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[10,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2020 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[11,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2021 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)

CUBS_TANK_DF[1,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2011 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[2,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2012 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[3,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2013 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[4,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2014 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[5,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2015 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[6,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2016 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[7,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2017 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[8,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2018 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[9,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2019 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[10,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2020 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[11,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2021 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)

LG_TANK_DF[1,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2011) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[2,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2012) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[3,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2013) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[4,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2014) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[5,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2015) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[6,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2016) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[7,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2017) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[8,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2018) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[9,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2019) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[10,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2020) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[11,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2021) ], na.rm = TRUE), digits = 3)

## Mean Length of FA contracts
ASTROS_TANK_DF[1,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2011 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[2,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2012 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[3,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2013 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[4,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2014 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[5,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2015 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[6,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2016 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[7,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2017 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[8,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2018 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[9,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2019 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[10,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2020 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[11,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2021 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)

CUBS_TANK_DF[1,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2011 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[2,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2012 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[3,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2013 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[4,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2014 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[5,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2015 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[6,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2016 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[7,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2017 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[8,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2018 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[9,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2019 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[10,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2020 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[11,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2021 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)

LG_TANK_DF[1,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2011 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[2,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2012 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[3,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2013 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[4,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2014 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[5,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2015 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[6,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2016 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[7,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2017 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[8,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2018 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[9,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2019 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[10,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2020 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[11,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2021 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)

## Mean Total Value of FA contracts
ASTROS_TANK_DF[1,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2011 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[2,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2012 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[3,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2013 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[4,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2014 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[5,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2015 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[6,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2016 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[7,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2017 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[8,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2018 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[9,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2019 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[10,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2020 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[11,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2021 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)

CUBS_TANK_DF[1,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2011 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[2,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2012 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[3,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2013 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[4,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2014 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[5,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2015 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[6,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2016 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[7,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2017 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[8,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2018 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[9,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2019 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[10,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2020 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[11,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2021 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)

LG_TANK_DF[1,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2011 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[2,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2012 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[3,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2013 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[4,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2014 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[5,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2015 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[6,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2016 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[7,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2017 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[8,16] = round(median(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2018 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[9,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2019 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[10,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2020 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[11,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2021 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)


## Team bWAR
ASTROS_TANK_DF[1,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2011)], digits = 1)
ASTROS_TANK_DF[2,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2012)], digits = 1)
ASTROS_TANK_DF[3,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2013)], digits = 1)
ASTROS_TANK_DF[4,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2014)], digits = 1)
ASTROS_TANK_DF[5,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2015)], digits = 1)
ASTROS_TANK_DF[6,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2016)], digits = 1)
ASTROS_TANK_DF[7,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2017)], digits = 1)
ASTROS_TANK_DF[8,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2018)], digits = 1)
ASTROS_TANK_DF[9,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2019)], digits = 1)
ASTROS_TANK_DF[10,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2020)], digits = 1)
ASTROS_TANK_DF[11,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2021)], digits = 1)

CUBS_TANK_DF[1,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2011)], digits = 1)
CUBS_TANK_DF[2,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2012)], digits = 1)
CUBS_TANK_DF[3,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2013)], digits = 1)
CUBS_TANK_DF[4,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2014)], digits = 1)
CUBS_TANK_DF[5,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2015)], digits = 1)
CUBS_TANK_DF[6,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2016)], digits = 1)
CUBS_TANK_DF[7,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2017)], digits = 1)
CUBS_TANK_DF[8,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2018)], digits = 1)
CUBS_TANK_DF[9,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2019)], digits = 1)
CUBS_TANK_DF[10,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2020)], digits = 1)
CUBS_TANK_DF[11,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2021)], digits = 1)

LG_TANK_DF[1,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2011) ]), digits = 1)
LG_TANK_DF[2,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2012) ]), digits = 1)
LG_TANK_DF[3,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2013) ]), digits = 1)
LG_TANK_DF[4,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2014) ]), digits = 1)
LG_TANK_DF[5,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2015) ]), digits = 1)
LG_TANK_DF[6,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2016) ]), digits = 1)
LG_TANK_DF[7,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2017) ]), digits = 1)
LG_TANK_DF[8,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2018) ]), digits = 1)
LG_TANK_DF[9,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2019) ]), digits = 1)
LG_TANK_DF[10,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2020) ]), digits = 1)
LG_TANK_DF[11,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2021) ]), digits = 1)

## Team Sal (payroll)
ASTROS_TANK_DF[1,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2011)], digits = 3)
ASTROS_TANK_DF[2,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2012)], digits = 3)
ASTROS_TANK_DF[3,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2013)], digits = 3)
ASTROS_TANK_DF[4,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2014)], digits = 3)
ASTROS_TANK_DF[5,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2015)], digits = 3)
ASTROS_TANK_DF[6,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2016)], digits = 3)
ASTROS_TANK_DF[7,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2017)], digits = 3)
ASTROS_TANK_DF[8,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2018)], digits = 3)
ASTROS_TANK_DF[9,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2019)], digits = 3)
ASTROS_TANK_DF[10,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2020)], digits = 3)
ASTROS_TANK_DF[11,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2021)], digits = 3)

CUBS_TANK_DF[1,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2011)], digits = 3)
CUBS_TANK_DF[2,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2012)], digits = 3)
CUBS_TANK_DF[3,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2013)], digits = 3)
CUBS_TANK_DF[4,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2014)], digits = 3)
CUBS_TANK_DF[5,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2015)], digits = 3)
CUBS_TANK_DF[6,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2016)], digits = 3)
CUBS_TANK_DF[7,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2017)], digits = 3)
CUBS_TANK_DF[8,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2018)], digits = 3)
CUBS_TANK_DF[9,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2019)], digits = 3)
CUBS_TANK_DF[10,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2020)], digits = 3)
CUBS_TANK_DF[11,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2021)], digits = 3)

LG_TANK_DF[1,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2011)]), digits = 3)
LG_TANK_DF[2,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2012)]), digits = 3)
LG_TANK_DF[3,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2013)]), digits = 3)
LG_TANK_DF[4,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2014)]), digits = 3)
LG_TANK_DF[5,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2015)]), digits = 3)
LG_TANK_DF[6,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2016)]), digits = 3)
LG_TANK_DF[7,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2017)]), digits = 3)
LG_TANK_DF[8,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2018)]), digits = 3)
LG_TANK_DF[9,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2019)]), digits = 3)
LG_TANK_DF[10,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2020)]), digits = 3)
LG_TANK_DF[11,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2021)]), digits = 3)

```

Add career bWAR of draftees to the dfs

```{r Merge TANK DFs, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
## Add Career WAR of draftees
ASTROS_TANK_DF = ASTROS_CUBS_DRAFT_SUB %>%
  group_by(Year) %>%
  filter(Tm == "Houston Astros") %>%
  summarize(Draft_Class_Career_WAR = sum(`Career WAR`, na.rm = T)) %>%
  select(Draft_Class_Career_WAR) %>%
  bind_cols(ASTROS_TANK_DF)
ASTROS_TANK_DF = ASTROS_TANK_DF %>%
  relocate(Draft_Class_Career_WAR, .after = 19)

CUBS_TANK_DF = ASTROS_CUBS_DRAFT_SUB %>%
  group_by(Year) %>%
  filter(Tm == "Chicago Cubs") %>%
  summarize(Draft_Class_Career_WAR = sum(`Career WAR`, na.rm = T)) %>%
  select(Draft_Class_Career_WAR) %>%
  bind_cols(CUBS_TANK_DF)
CUBS_TANK_DF = CUBS_TANK_DF %>%
    relocate(Draft_Class_Career_WAR, .after = 19)

LG_TANK_DF = LEAGUE_DRAFT_SUB %>%
  group_by(Year) %>%
  summarize(Draft_Class_Career_WAR = sum(`Career WAR`, na.rm = T)/28) %>%
  select(Draft_Class_Career_WAR) %>%
  bind_cols(LG_TANK_DF)
LG_TANK_DF = LG_TANK_DF %>%
  relocate(Draft_Class_Career_WAR, .after = 19)
LG_TANK_DF[ , 19] = round(LG_TANK_DF[ , 19], digits = 1)
  
## Add "WARPM" (WAR Per Million $) col
ASTROS_TANK_DF$WARPM = round(ASTROS_TANK_DF$`Team bWAR` / ASTROS_TANK_DF$`Team payroll`, digits = 2)
CUBS_TANK_DF$WARPM = round(CUBS_TANK_DF$`Team bWAR` / CUBS_TANK_DF$`Team payroll`, digits = 2)
LG_TANK_DF$WARPM = round(LG_TANK_DF$`Team bWAR` / LG_TANK_DF$`Team payroll`, digits = 2)

## Add Team col
ASTROS_TANK_DF$Tm = "Houston Astros"
CUBS_TANK_DF$Tm = "Chicago Cubs"
LG_TANK_DF$Tm = "LeagueAVG"
TANK_DF = rbind.data.frame(ASTROS_TANK_DF, CUBS_TANK_DF, LG_TANK_DF)
```

## Create and Clean the df for Tankers

```{r REBUILDERS_df and plotly creation, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
REBUILDERS_df = TeamValALL %>%
  group_by(`Tm`, Year) %>%
  filter(L >= 92)

  ## Remove the Red Sox, Indians/Guardians, Brewers, Mets, Giants, Rays, Jays, Nats (idx = 5, 7, 23, 35, 40, 30, 52, 58)
REBUILDERS_df = REBUILDERS_df[ -c(5, 7, 23, 35, 40, 30, 52, 58), ]

REBUILDERS_df = REBUILDERS_df %>%
  group_by(`Tm`, Year) %>%
  arrange(`Tm`, Year) %>%
  ungroup()

REBUILDERS_df$GB = as.double(REBUILDERS_df$GB)
colnames(REBUILDERS_df)[c(8:13)] = c("MLB Trades Made", "FA Signings", "Minors Callups", "Payroll Sum", "bWAR", "Payroll (in M $US)")
head(REBUILDERS_df[c(4,5,7:11,13:16,20:27,31:38,41,42,45,46,52:54),-11])

  ## Remove non-qualifiers
Printable_REBUILD = REBUILDERS_df[c(4,5,7:11,13:16,20:27,31:38,41,42,45,46),-11]

  ## Re-arrange for display
Printable_REBUILD = Printable_REBUILD %>%
  select(`Tm`, Year, W, L, W_L, GB, DivRank, `MLB Trades Made`, `FA Signings`, `Minors Callups`, bWAR, `Payroll (in M $US)`)

  ## For plotting
Rebuild_T = plot_ly(
  type = 'table',
  columnwidth = c(rep(20,12)),
  columnorder = c(seq(1,12,1)),
  header = list(
    values = c(colnames(Printable_REBUILD)),
    align = c("center", "center"),
    line = list(width = 1, color = 'black'),
    fill = list(color = c("grey", "grey")),
    font = list(family = "Times", size = 14, color = "black")
  ),
  cells = list(
    values = rbind(Printable_REBUILD$Tm,
                   Printable_REBUILD$Year,
                   Printable_REBUILD$W,
                   Printable_REBUILD$L,
                   Printable_REBUILD$W_L,
                   Printable_REBUILD$GB,
                   Printable_REBUILD$DivRank,
                   Printable_REBUILD$`MLB Trades Made`,
                   Printable_REBUILD$`FA Signings`,
                   Printable_REBUILD$`Minors Callups`,
                   Printable_REBUILD$bWAR,
                   Printable_REBUILD$`Payroll (in M $US)`),
    align = c("center", "center"),
    line = list(color = "black", width = 1),
    font = list(family = "Times", size = 12, color = c("black"))
  ))
```
