---
title: "Tanking Data Wrangling"
author: "Erik Larsen"
date: "4/23/2022"
output: html_document
---

This snippet was used in my article (currently under review) on [TheLeftyCatcher](https://www.theleftycatcher.com), where I compared and contrasted how `Jeff Luhnow` and `Theo Epstein` tanked to rebuild the `Chicago Cubs` and `Houston Astros`, beginning in ~2011 into World Series winners. I acquired `MLB Free Agent` data, `MLB Amateur Draft` data, `International Signing` data, `MLB Standings` data, `MLB Payroll` data, and "`MLB Value`" data. I scraped or downloaded this data from multiple sites, including `Baseball Reference`, `ESPN`, and `Baseball Almanac`. It required some processing to compile and analyze with or without graphs.

Subsequent pieces and snippets will revolve around this data.


```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.show = TRUE)
```

## Load packages

```{r Package loading, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Data wrangling; df re-arrangement, string manipulations
library(readr)
library(reshape2)
library(tidyverse)
library(stringr)

  ## Web scraping
library(rvest)
library(XML)

  ## Plotting
library(ggplot2)
library(ggrepel)
library(GGally)
library(ggpubr)
library(plotly)

  ## Modeling
library(mgcv)
library(splines)
```

## Scrape and Clean Amateur Draft Data

Amateur draft data from Baseball Almanac

```{r Scrape and clean amateur draft data from Baseball Almanac pt.1, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Create a selector for the relevant element
almanac_selector = "#wrapper > div.container > div.ba-table > table"

    ## Create a function to scrape the Baseball Almanac draft data
BBA_import_fn = function(Year, selector){
    ## Read in the URL with desired year and selector
  df = read_html(
    paste("https://www.baseball-almanac.com/draft/baseball-draft.php?yr=20", Year, sep = ""), encoding = "UTF8"
  ) %>%
    html_element(css = selector) %>%
    html_table()
    ## Remove the first row
  df = df[ -1, ]
    ## Re-name the columns
  colnames(df) = df[ 1, ]
    ## Remove the first row and last two rows
  df = df[ -1, ]
  df = df[ -nrow(df), ]
  df = df[ -nrow(df), ]
    ## Coerce Rd and pick (`#`) numbers to be numeric (integers)
  df$Rd = as.numeric(df$Rd)
  df$`#` = as.numeric(df$`#`)
    ## Co-erce the Name strings into UTF-8 encoding
  Encoding(df$`Player Name`) = "UTF-8"
  df$`Player Name` = iconv(df$`Player Name`, "UTF-8", "UTF-8", sub = " ")
    ## Add a "year" column for eventual df merging
  df$Year = as.numeric(paste("20", Year, sep = ""))
    ## Save the dataframe as a variable to the global environment
  assign(paste("BBA20", Year, sep = ""), df, envir = .GlobalEnv)
}
  ## Loop through and scrape the data starting from Epstein and Luhnow hires with Cubs/Astros (2011) to present
for ( i in 11:21 ){
  BBA_import_fn(Year = i, selector = almanac_selector)
}
  ## Merge the dataframes together
BBA_DRAFT_ALL = rbind.data.frame(BBA2011, BBA2012, BBA2013, BBA2014, BBA2015, BBA2016, BBA2017, BBA2018, BBA2019, BBA2020, BBA2021)
rm(BBA2011, BBA2012, BBA2013, BBA2014, BBA2015, BBA2016, BBA2017, BBA2018, BBA2019, BBA2020, BBA2021)

Encoding(BBA_DRAFT_ALL$`Player Name`) = "UTF-8"
BBA_DRAFT_ALL$`Player Name` = iconv(BBA_DRAFT_ALL$`Player Name`, "UTF-8", "UTF-8", sub = " ")

  ## Fix team name mistakes
BBA_DRAFT_ALL$`Drafted By`[ which(BBA_DRAFT_ALL$`Drafted By` == "Chicago") ] = "Chicago Cubs"
BBA_DRAFT_ALL$`Drafted By`[ which(BBA_DRAFT_ALL$`Drafted By` == "Florida Marlins") ] = "Miami Marlins"
BBA_DRAFT_ALL$`Drafted By`[ grep(BBA_DRAFT_ALL$`Drafted By`, pattern = "Miami") ] = "Miami Marlins"
BBA_DRAFT_ALL$`Drafted By`[ grep(BBA_DRAFT_ALL$`Drafted By`, pattern = "Phillies") ] = "Philadelphia Phillies"
BBA_DRAFT_ALL$`Drafted By`[ grep(BBA_DRAFT_ALL$`Drafted By`, pattern = "Pittsburg") ] = "Pittsburg Pirates"
BBA_DRAFT_ALL$`Drafted By`[ grep(BBA_DRAFT_ALL$`Drafted By`, pattern = "Baltimore") ] = "Baltimore Orioles"
BBA_DRAFT_ALL$`Drafted By`[ grep(BBA_DRAFT_ALL$`Drafted By`, pattern = "Athletics") ] = "Oakland Athletics"
BBA_DRAFT_ALL$`Drafted By`[ grep(BBA_DRAFT_ALL$`Drafted By`, pattern = "Anaheim") ] = "Los Angeles Angels"
BBA_DRAFT_ALL$`Drafted By`[ grep(BBA_DRAFT_ALL$`Drafted By`, pattern = "Senators") ] = "Oakland Athletics"

  ## Change " `Drafted By` " to "Tm", and " `Player Name` " to "Name"
colnames(BBA_DRAFT_ALL)[4] = "Name"
colnames(BBA_DRAFT_ALL)[5] = "Tm"
```

Small function to analyze college draft selections

```{r Write a small function that analyzes draft selections, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}

  ## Create a function that analyzes the number of college picks by position of a given team in a given year
Draft_df_Analysis = function(df, Team){
  
  ## Loop through and determine how many of which position a given team drafted in a given draft; how many of all were college picks
  for(i in levels(as.factor(df$POS[which(df$Tm == Team)]))){
    print(
      paste(
        sum(str_count(df$POS[which(df$Tm == Team)], i)),
        i,
        ";",
        length(which(grepl(df$`Drafted From`[ which(df$Tm == Team)],
                           pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech") == TRUE)),
        "/",
        length(which(df$Tm == Team) == TRUE),
        "College Picks")
    )
  }
}
  ## Note that there may be duplicates in some dfs; better to perform analysis after duplicates are removed
Draft_df_Analysis(df = BBA_DRAFT_ALL, Team = "New York Yankees")
```


Check the details on the Astros' and Cubs' First 5 Rd selections from 2011-2021

```{r Scrape and clean amateur draft data from Baseball Almanac pt.2, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
print(BBA_DRAFT_ALL[ which(BBA_DRAFT_ALL$Tm == "Houston Astros" & BBA_DRAFT_ALL$Rd <= 5 ), ], n = 59)
print(BBA_DRAFT_ALL[ which(BBA_DRAFT_ALL$Tm == "Chicago Cubs" & BBA_DRAFT_ALL$Rd <= 5), ], n = 58)
```



## Scrape and Clean Baseball Reference Standings Data

```{r Scrape standings data from Baseball Reference, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Create a function to import the standings from 2011-2021 according to Baseball Reference
br_stand_fn = function(Year){
  df = read_html(
    paste("https://www.baseball-reference.com/leagues/majors/20",
          Year,
          "-standings.shtml#expanded_standings_overall",
          sep = "")
  ) %>%
    html_table()
  ## Combine the divisions into one standings dataframe
  df = reduce(df[][], full_join, by = c("Tm", "W", "L", "W-L%", "GB"))
  ## Convert the table into a dataframe
  df = as.data.frame(df)
  ## Add rankings within divisions
  df$DivRank = rep(c(1:5), 6)
  ## Re-order by most wins
  df = df[order(df$W, decreasing = TRUE),]
  ## Add a column to track the year for future df merging
  df$Year = as.numeric(paste("20", Year, sep = ""))
  ## Save the dataframe as a variable to the global environment
  assign(paste("Standings_20", Year, sep = ""), df, envir = .GlobalEnv)
}
  ## Loop through and import the standings from 2011-2021
for ( i in 11:21 ) {
  br_stand_fn(Year = i)
}

StandALL = rbind.data.frame(Standings_2011, Standings_2012, Standings_2013, Standings_2014, Standings_2015, Standings_2016, Standings_2017, Standings_2018, Standings_2019, Standings_2020, Standings_2021)

StandALL$Tm[ which(StandALL$Tm == "Los Angeles Angels of Anaheim")] = "Los Angeles Angels"
StandALL$Tm[ which(StandALL$Tm == "Florida Marlins")] = "Miami Marlins"

rm(Standings_2011, Standings_2012, Standings_2013, Standings_2014, Standings_2015, Standings_2016, Standings_2017, Standings_2018, Standings_2019, Standings_2020, Standings_2021)
```


## Import and clean "player value" Data from `Baseball Reference`

Import

```{r Import player WAR and salary data downloaded from Baseball Reference, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Import player value stats downloaded from Baseball Reference
setwd("C:/Users/Erik/Desktop/BoxCopy/Programming Scripts and Data/Baseball/Projects/Tanking/")
files = list.files(pattern = "Player_Value")
for ( i in 1:length(files) ) {
  as.data.frame(
    assign(
      gsub(".csv", "", files[], fixed = TRUE)[i], read.csv(file = files[i]))
  )
}
```

Clean the data

```{r Clean Baseball Reference player stats data pt.1, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}

## Add "playerID" to the playerID column
  ## For position players
PP_val_colnames = colnames(Player_Value_Batting_2011)
PP_val_colnames = c(PP_val_colnames[c(1,2)], "playerID", PP_val_colnames[c(3:(length(PP_val_colnames)-1))])
  ## For pitchers
PO_val_colnames = colnames(Player_Value_Pitching_2011)
PO_val_colnames = c(PO_val_colnames[c(1,2)], "playerID", PO_val_colnames[c(3:(length(PO_val_colnames)-1))])
  ## 2020, 2021 have Xinn value added; account for the extra column
Player_Value_Pitching_2020 = Player_Value_Pitching_2020[ , -13]
Player_Value_Pitching_2021 = Player_Value_Pitching_2021[ , -13]

  ## Correct column names
colnames(Player_Value_Batting_2011) = PP_val_colnames
colnames(Player_Value_Pitching_2011) = PO_val_colnames
```

Repeat the column name revisions for all the dfs (not shown)

```{r Clean Baseball Reference player stats data pt.2, include = TRUE, warning = FALSE, echo = FALSE, message = FALSE}
colnames(Player_Value_Batting_2012) = PP_val_colnames
colnames(Player_Value_Batting_2013) = PP_val_colnames
colnames(Player_Value_Batting_2014) = PP_val_colnames
colnames(Player_Value_Batting_2015) = PP_val_colnames
colnames(Player_Value_Batting_2016) = PP_val_colnames
colnames(Player_Value_Batting_2017) = PP_val_colnames
colnames(Player_Value_Batting_2018) = PP_val_colnames
colnames(Player_Value_Batting_2019) = PP_val_colnames
colnames(Player_Value_Batting_2020) = PP_val_colnames
colnames(Player_Value_Batting_2021) = PP_val_colnames

colnames(Player_Value_Pitching_2012) = PO_val_colnames
colnames(Player_Value_Pitching_2013) = PO_val_colnames
colnames(Player_Value_Pitching_2014) = PO_val_colnames
colnames(Player_Value_Pitching_2015) = PO_val_colnames
colnames(Player_Value_Pitching_2016) = PO_val_colnames
colnames(Player_Value_Pitching_2017) = PO_val_colnames
colnames(Player_Value_Pitching_2018) = PO_val_colnames
colnames(Player_Value_Pitching_2019) = PO_val_colnames
colnames(Player_Value_Pitching_2020) = PO_val_colnames
colnames(Player_Value_Pitching_2021) = PO_val_colnames
```

Put the hitter and pitcher value dfs into separate lists to loop through for cleaning

```{r Clean Baseball Reference player stats data pt.3, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
Hitter_Value_df_list = ls()[
  which(grepl(ls(), pattern = "Player_Value_Batting") == TRUE)
]
Pitcher_Value_df_list = ls()[
  which(grepl(ls(), pattern = "Player_Value_Pitching") == TRUE)
]

## Create a function to clean the hitter dfs
clean_br_hitter_value_df_fn = function(df){
  ## Remove the "Rk" column
  df = df[ , -1 ]
  ## Remove the handedness coded into the "Name" column
  df$Name = gsub(df$Name, pattern = "\\*|\\#", replacement = "")
  Encoding(df$Name) = "UTF-8"
  df$Name = iconv(df$Name, "UTF-8", "UTF-8", sub = " ")
  colnames(df)[24] = "Pos.Summary"
  ## Remove pitchers from the hitters df
  df = df[ -which(grepl(df$Pos.Summary, pattern = "1|\\/1|([0-9]-Jan)" ) == TRUE), ]
  ## Convert the "salary" column
  df$Salary = as.numeric(gsub(df$Salary, pattern = "\\$|\\,", replacement = ""))/1000000
  rownames(df) = NULL
  return(df)
}

## Create functions to clean the pitcher dfs
clean_br_pitcher_value_df_fn = function(df){
  ## Remove the "Rk" column
  df = df[ , -1 ]
  ## Remove the handedness coded into the "Name" column
  df$Name = gsub(df$Name, pattern = "\\*|\\#", replacement = "")
  ## Convert to UTF-8 and remove special characters
  Encoding(df$Name) = "UTF-8"
  df$Name = iconv(df$Name, "UTF-8", "UTF-8", sub = " ")
  ## Convert the "salary" column
  df$Salary = as.numeric(gsub(df$Salary, pattern = "\\$|\\,", replacement = ""))/1000000
  rownames(df) = NULL
  return(df)
}
## Loop through and concatenate the df variable names into a list
for (i in 1:length(Hitter_Value_df_list) ){
  Hitter_Value_df_list[i] = rbind.data.frame(Hitter_Value_df_list[i])
  Pitcher_Value_df_list[i] = rbind.data.frame(Pitcher_Value_df_list[i])
}
## Clean the dfs
cleaned_br_hitter_val_df_list = lapply(mget(unlist(Hitter_Value_df_list)), clean_br_hitter_value_df_fn)
cleaned_br_pitcher_val_df_list = lapply(mget(unlist(Pitcher_Value_df_list)), clean_br_pitcher_value_df_fn)

## Add each df's Year as a column
cleaned_br_hitter_val_df_list[[1]]$Year = 2011
cleaned_br_pitcher_val_df_list[[1]]$Year = 2011
```

Add each df's `Year` as a column for all `cleaned_br_hitter_val_df_list` or `cleaned_br_pitcher_val_df_list` objects (not shown)

```{r Clean Baseball Reference player stats data pt.4, include = TRUE, warning = FALSE, echo = FALSE, message = FALSE}
cleaned_br_hitter_val_df_list[[2]]$Year = 2012
cleaned_br_hitter_val_df_list[[3]]$Year = 2013
cleaned_br_hitter_val_df_list[[4]]$Year = 2014
cleaned_br_hitter_val_df_list[[5]]$Year = 2015
cleaned_br_hitter_val_df_list[[6]]$Year = 2016
cleaned_br_hitter_val_df_list[[7]]$Year = 2017
cleaned_br_hitter_val_df_list[[8]]$Year = 2018
cleaned_br_hitter_val_df_list[[9]]$Year = 2019
cleaned_br_hitter_val_df_list[[10]]$Year = 2020
cleaned_br_hitter_val_df_list[[11]]$Year = 2021

cleaned_br_pitcher_val_df_list[[2]]$Year = 2012
cleaned_br_pitcher_val_df_list[[3]]$Year = 2013
cleaned_br_pitcher_val_df_list[[4]]$Year = 2014
cleaned_br_pitcher_val_df_list[[5]]$Year = 2015
cleaned_br_pitcher_val_df_list[[6]]$Year = 2016
cleaned_br_pitcher_val_df_list[[7]]$Year = 2017
cleaned_br_pitcher_val_df_list[[8]]$Year = 2018
cleaned_br_pitcher_val_df_list[[9]]$Year = 2019
cleaned_br_pitcher_val_df_list[[10]]$Year = 2020
cleaned_br_pitcher_val_df_list[[11]]$Year = 2021
```
Loop through and find **position players** in the ``player value pitching df``. Remove them


```{r Clean Baseball Reference player stats data pt.5, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Initialize vector
temp = vector()
for ( i in 1:length(cleaned_br_pitcher_val_df_list) ) {
  for ( j in 1:nrow(cleaned_br_pitcher_val_df_list[[i]])) {
    if ( cleaned_br_pitcher_val_df_list[[i]]$playerID[j] %in% cleaned_br_hitter_val_df_list[[i]]$playerID ){
      ## Identify matches of playerID, store in temp vector
      temp[j] = which(cleaned_br_hitter_val_df_list[[i]]$playerID == cleaned_br_pitcher_val_df_list[[i]]$playerID[j])
      temp = temp[which(!is.na(temp))]
      ## Remove the position players from the pitcher dfs
      cleaned_br_pitcher_val_df_list[[i]] = cleaned_br_pitcher_val_df_list[[i]][ -temp, ]
    }
  }
}
#sort(unique(cleaned_br_hitter_val_df_list[[1]]$Tm))
```

Put the cleaned Hitter Value dfs into one df for easier calculation of career `bWAR`s

```{r Clean Baseball Reference player stats data pt.6, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
CAREER_hitter_WAR_df = data.frame()
CAREER_hitter_WAR_df = rbind.data.frame(cleaned_br_hitter_val_df_list[[1]][c(1,2,16,22,25)], cleaned_br_hitter_val_df_list[[2]][c(1,2,16,22,25)],
                                        cleaned_br_hitter_val_df_list[[3]][c(1,2,16,22,25)], cleaned_br_hitter_val_df_list[[4]][c(1,2,16,22,25)],
                                        cleaned_br_hitter_val_df_list[[5]][c(1,2,16,22,25)], cleaned_br_hitter_val_df_list[[6]][c(1,2,16,22,25)],
                                        cleaned_br_hitter_val_df_list[[7]][c(1,2,16,22,25)], cleaned_br_hitter_val_df_list[[8]][c(1,2,16,22,25)],
                                        cleaned_br_hitter_val_df_list[[9]][c(1,2,16,22,25)], cleaned_br_hitter_val_df_list[[10]][c(1,2,16,22,25)],
                                        cleaned_br_hitter_val_df_list[[11]][c(1,2,16,22,25)])
## Calculate hitter career WAR and put it into a dataframe
HitterCareerWAR = aggregate(x = CAREER_hitter_WAR_df$WAR, by = list(CAREER_hitter_WAR_df$playerID), FUN = sum)
HitterCareerWAR = as.data.frame(HitterCareerWAR)
colnames(HitterCareerWAR) = c("playerID", "Career WAR")
HitterCareerWAR$`Career WAR` = round(HitterCareerWAR$`Career WAR`, digits = 3)
HitterCareerWAR = add_column(HitterCareerWAR, Name = "", .before = 1)
## Edit hitter names into the dataframe by looping through
dummy = vector()
for (i in HitterCareerWAR$playerID ){
  dummy[i] = CAREER_hitter_WAR_df$Name[which(CAREER_hitter_WAR_df$playerID == i)]
}
HitterCareerWAR$Name = dummy
```

Repeat the cleaning process above for pitchers (not shown)

```{r Clean Baseball Reference player stats data pt.7, include = TRUE, warning = FALSE, echo = FALSE, message = FALSE}
## Repeat above for pitchers
CAREER_pitcher_WAR_df = data.frame()
CAREER_pitcher_WAR_df = rbind.data.frame(cleaned_br_pitcher_val_df_list[[1]][c(1,2,19,23,25)], cleaned_br_pitcher_val_df_list[[2]][c(1,2,19,23,25)],
                                         cleaned_br_pitcher_val_df_list[[3]][c(1,2,19,23,25)], cleaned_br_pitcher_val_df_list[[4]][c(1,2,19,23,25)],
                                         cleaned_br_pitcher_val_df_list[[5]][c(1,2,19,23,25)], cleaned_br_pitcher_val_df_list[[6]][c(1,2,19,23,25)],
                                         cleaned_br_pitcher_val_df_list[[7]][c(1,2,19,23,25)], cleaned_br_pitcher_val_df_list[[8]][c(1,2,19,23,25)],
                                         cleaned_br_pitcher_val_df_list[[9]][c(1,2,19,23,25)], cleaned_br_pitcher_val_df_list[[10]][c(1,2,19,23,25)],
                                         cleaned_br_pitcher_val_df_list[[11]][c(1,2,19,23,25)])
## Calculate pitcher Career WAR and put it into a dataframe
PitcherCareerWAR = aggregate(x = CAREER_pitcher_WAR_df$WAR, by = list(CAREER_pitcher_WAR_df$playerID), FUN = sum)
PitcherCareerWAR = as.data.frame(PitcherCareerWAR)
colnames(PitcherCareerWAR) = c("playerID", "Career WAR")
PitcherCareerWAR$`Career WAR` = round(PitcherCareerWAR$`Career WAR`, digits = 3)
PitcherCareerWAR = add_column(PitcherCareerWAR, Name = "", .before = 1)
## Edit pitcher names into the dataframe by looping through
dummy = vector()
for (i in PitcherCareerWAR$playerID ){
  dummy[i] = CAREER_pitcher_WAR_df$Name[which(CAREER_pitcher_WAR_df$playerID == i)]
}
PitcherCareerWAR$Name = dummy
```

Combine Career bWAR dfs

```{r Clean Baseball Reference player stats data pt.8, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
## Combine the career WAR dfs
PLAYER_CAREER_WAR = rbind.data.frame(HitterCareerWAR, PitcherCareerWAR)
PLAYER_CAREER_WAR = PLAYER_CAREER_WAR %>%
  arrange(desc(`Career WAR`))

Encoding(PLAYER_CAREER_WAR$Name) = "UTF-8"
PLAYER_CAREER_WAR$Name = iconv(PLAYER_CAREER_WAR$Name, "UTF-8", "UTF-8", sub = " ")

PLAYER_CAREER_WAR = PLAYER_CAREER_WAR[ -which(duplicated(PLAYER_CAREER_WAR$Name) == TRUE), ]

```

## Scrape and Clean Team bWAR and salary/payroll data from `Baseball Reference`

```{r Scrape and clean team bWAR and salary/payroll data from Baseball Reference, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Create a function that will import team value tables from Baseball Reference (for pitching stats and hitting stats)
br_team_value_import_fn = function(Year, Player_data_type) {
  ## Read in the URL with desired year and player type
  df = read_html(
    paste("https://www.baseball-reference.com/leagues/majors/20", Year, "-value-", Player_data_type, ".shtml", sep = "")
  ) %>%
    html_table()
  ## Convert the table into a dataframe
  df = as.data.frame(df)
  ## Remove the duplicate row on the bottom
  df = df[ -32, ]
  ## Remove the "$" signs and ","s and divide the salaries by 1M
  df$Salary = as.numeric(
    gsub(df$Salary, pattern = "\\$|\\,", replacement = ""))/1000000
  ## Add a column to track the year for future df merging
  df$Year = as.numeric(paste("20", Year, sep = ""))
  ## Save the dataframe as a variable to the global environment
  assign(paste("Team_", Player_data_type, "value_20", Year, sep = ""), df, envir = .GlobalEnv)
}
  ## Loop through the relevant years and import the tables as dataframes
for ( i in 11:21 ){
  br_team_value_import_fn(Year = i, Player_data_type = "batting")
}
  ## Repeat the loop for pitching stats
for ( i in 11:21 ){
  br_team_value_import_fn(Year = i, Player_data_type = "pitching")
}
  ## Concatenate into a aggregate dataframes by player type
TeamBatALL = rbind.data.frame(Team_battingvalue_2011[c(1:30),],Team_battingvalue_2012[c(1:30),], Team_battingvalue_2013[c(1:30),],
                              Team_battingvalue_2014[c(1:30),],Team_battingvalue_2015[c(1:30),], Team_battingvalue_2016[c(1:30),],
                              Team_battingvalue_2017[c(1:30),],Team_battingvalue_2018[c(1:30),], Team_battingvalue_2019[c(1:30),],
                              Team_battingvalue_2020[c(1:30),],Team_battingvalue_2021[c(1:30),])

TeamBatALL$Tm[ which(TeamBatALL$Tm == "Los Angeles Angels of Anaheim")] = "Los Angeles Angels"
TeamBatALL$Tm[ which(TeamBatALL$Tm == "Florida Marlins")] = "Miami Marlins"

  ## BR added a value metric to Xinn pitching (col 10)
    ## Remove to concatenate
TeamPitALL = rbind.data.frame(Team_pitchingvalue_2011[c(1:30),], Team_pitchingvalue_2012[c(1:30),], Team_pitchingvalue_2013[c(1:30),],
                              Team_pitchingvalue_2014[c(1:30),], Team_pitchingvalue_2015[c(1:30),], Team_pitchingvalue_2016[c(1:30),],
                              Team_pitchingvalue_2017[c(1:30),], Team_pitchingvalue_2018[c(1:30),], Team_pitchingvalue_2019[c(1:30),],
                              Team_pitchingvalue_2020[c(1:30),-10], Team_pitchingvalue_2021[c(1:30),-10])

TeamPitALL$Tm[ which(TeamPitALL$Tm == "Los Angeles Angels of Anaheim")] = "Los Angeles Angels"
TeamPitALL$Tm[ which(TeamPitALL$Tm == "Florida Marlins")] = "Miami Marlins"

  ## Convert the WAR and Salary columns to numerical data to add together in a new df
TeamBatALL$WAR = as.numeric(TeamBatALL$WAR)
TeamBatALL$Salary = as.numeric(TeamBatALL$Salary)
TeamPitALL$WAR = as.numeric(TeamPitALL$WAR)
TeamPitALL$Salary = as.numeric(TeamPitALL$Salary)

```

Add player acquisition data to the cleaned `Baseball Reference` player value data

```{r Add player acquisition data to the Baseball Reference player value data pt.1, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Iniitialize vector
df = vector()
  ## Loop through and tab each team's number of acqusitions for the main acq. types in each year;
    ## Put them in their own dfs
      ## For hitters
for(i in 1:11){
  df = cleaned_br_hitter_val_df_list[[i]][-which(cleaned_br_hitter_val_df_list[[i]]$Tm == "2TM" |
                                                   cleaned_br_hitter_val_df_list[[i]]$Tm == "3TM" |
                                                   cleaned_br_hitter_val_df_list[[i]]$Tm == "4TM" |
                                                   cleaned_br_hitter_val_df_list[[i]]$Tm == "5TM"),
  ] %>%
    group_by(Tm, Year) %>%
    summarise(Sum_Num_Trades = sum(length(which(Acquired == "Traded"))),
              Sum_Num_FAs = sum(length(which(Acquired == "Free Agency"))),
              Sum_Num_Ams = sum(length(which(Acquired == "Amateur Draft" | Acquired == "Amateur Free Agent"))),
              Sum_Sal = sum(Salary, na.rm = T)) %>%
    arrange(Tm) %>%
    as.data.frame()
  assign(paste("HitterAcqs_", i, sep = ""), df, .GlobalEnv)
}
```

Repeat for pitchers

```{r Add player acquisition data to the Baseball Reference player value data pt.2, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
df = vector()
for(i in 1:11){
  df = cleaned_br_pitcher_val_df_list[[i]][-which(cleaned_br_pitcher_val_df_list[[i]]$Tm == "2TM" |
                                                    cleaned_br_pitcher_val_df_list[[i]]$Tm == "3TM" | 
                                                    cleaned_br_pitcher_val_df_list[[i]]$Tm == "4TM" |
                                                    cleaned_br_pitcher_val_df_list[[i]]$Tm == "5TM"),] %>%
    group_by(Tm, Year) %>%
    summarise(Sum_Num_Trades = sum(length(which(Acquired == "Traded"))),
              Sum_Num_FAs = sum(length(which(Acquired == "Free Agency"))),
              Sum_Num_Ams = sum(length(which(Acquired == "Amateur Draft" | Acquired == "Amateur Free Agent"))),
              Sum_Sal = sum(Salary, na.rm = T)) %>%
    arrange(Tm) %>%
    as.data.frame()
  assign(paste("PitcherAcqs_", i, sep = ""), df, .GlobalEnv)
}
```

Concatenate the acquisition dfs into a list of dfs; prep the data to be joined to the `TeamBatALL`, `TeamPitALL` dfs

```{r Prep Baseball Reference value data pt.1, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Concatenate into a list of dfs
HitterAcqs = mget(
  unlist(
    ls()[
      which(grepl(ls(), pattern = "HitterAcqs_") == TRUE)
    ][c(1,4:11,2,3)]
  )
)
PitcherAcqs = mget(
  unlist(
    ls()[
      which(grepl(ls(), pattern = "PitcherAcqs_") == TRUE)
    ][c(1,4:11,2,3)]
  )
)
  ## Remove the individual dfs
rm(list = 
     ls()[grep(ls()[], pattern = "HitterAcqs_|PitcherAcqs_")]
)
  ## Re-name the Marlins
PitcherAcqs[[1]]$Tm[which(PitcherAcqs[[1]]$Tm == "FLA")] = "MIA"
HitterAcqs[[1]]$Tm[which(HitterAcqs[[1]]$Tm == "FLA")] = "MIA"
  ## Re-order the list of dfs alphabetically
PitcherAcqs[[1]] = PitcherAcqs[[1]][order(PitcherAcqs[[1]]$Tm),]
HitterAcqs[[1]] = HitterAcqs[[1]][order(HitterAcqs[[1]]$Tm),]
  ## Match names with full official names
for(i in 1:11){
  PitcherAcqs[[i]]$Tm = unique(sort(StandALL$Tm))
  HitterAcqs[[i]]$Tm = unique(sort(StandALL$Tm))
}
  ## Re-arrange dfs into one df, housing the acq. data
PitcherAcqs = bind_rows(PitcherAcqs, .id = "column_label")
PitcherAcqs = PitcherAcqs %>%
  select(Tm, Year, Sum_Num_Trades, Sum_Num_FAs, Sum_Num_Ams, Sum_Sal)

HitterAcqs = bind_rows(HitterAcqs, .id = "column_label")
HitterAcqs = HitterAcqs %>%
  select(Tm, Year, Sum_Num_Trades, Sum_Num_FAs, Sum_Num_Ams, Sum_Sal)

  ## Join with Team Value data and remove extra data
TeamBatALL = HitterAcqs %>%
  left_join(TeamBatALL) %>%
  select(Tm, Year, Sum_Num_Trades, Sum_Num_FAs, Sum_Num_Ams, Sum_Sal, WAR, Salary)
TeamPitALL = PitcherAcqs %>%
  left_join(TeamPitALL) %>%
  select(Tm, Year, Sum_Num_Trades, Sum_Num_FAs, Sum_Num_Ams, Sum_Sal, WAR, Salary)
```

Combine into one `TeamValALL` df

```{r Prep Baseball Reference value data pt.2, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Combine team pitching and team hitting WAR, salary
TeamValALL = TeamBatALL
TeamValALL[,c(3:8)] = TeamBatALL[,c(3:8)] + TeamPitALL[,c(3:8)]

TeamValALL = StandALL %>%
  inner_join(TeamValALL)
colnames(TeamValALL)[4] = "W_L"

  ## Remove temp dfs
rm(Team_battingvalue_2011, Team_battingvalue_2012, Team_battingvalue_2013, Team_battingvalue_2014, Team_battingvalue_2015, Team_battingvalue_2016, Team_battingvalue_2017, Team_battingvalue_2018, Team_battingvalue_2019, Team_battingvalue_2020, Team_battingvalue_2021)
rm(Team_pitchingvalue_2011, Team_pitchingvalue_2012, Team_pitchingvalue_2013, Team_pitchingvalue_2014, Team_pitchingvalue_2015, Team_pitchingvalue_2016, Team_pitchingvalue_2017, Team_pitchingvalue_2018, Team_pitchingvalue_2019, Team_pitchingvalue_2020, Team_pitchingvalue_2021)

head(TeamValALL)
```

## Scrape MLB Free-Agent Data from ESPN

```{r Scrape and clean Free-Agent data from ESPN, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
## Create a function to scrape Free-Agent Data from ESPN
ESPN_FA_import_fn = function(Year, selector){
  df = read_html(
    paste("https://www.espn.com/mlb/freeagents/_/year/20", Year, "/type/signed", sep = "")
  ) %>%
    html_element(css = selector) %>%
    html_table()
  df = as.data.frame(df)
  df = df[ -c(1,nrow(df)), -c(4,5,8)]
  df = df[ -which(df$X1 == "PLAYER"), ]
    ## Duplicate the total value column
  df$TotalValue = df$X9
    ## Add a column of character values, describing whether the contract was a minors contract
  df$Type = ""
    ## Fill values of Minor Lg contracts with "MiLB" string
  if ( length(
    which(grepl(df$X9, pattern = "Minor Lg") == TRUE)
  ) > 0){
    df$Type[ which(grepl(df$X9, pattern = "Minor Lg") == TRUE) ] = "MiLB"
  } 
  if ( length(
    which(grepl(df$X9, pattern = "--") == TRUE) 
  ) > 0 ){
    df$Type[ which(grepl(df$X9, pattern = "--") == TRUE) ] = "Undisclosed"
  }
  df$Type[ which(grepl(df$X9, pattern = "\\,") == TRUE) ] = "MLB"
  
    ## Change undisclosed contract values to 0
  df$X9[ which(grepl(df$X9, pattern = "--") == TRUE) ] = 0
    ## Change minor league deal values to 0
  df$X9[ which(grepl(df$X9, pattern = "Minor Lg") == TRUE) ] = 0
  
    ## Change undisclosed contract values to 0
  df$TotalValue[ which(grepl(df$TotalValue, pattern = "--") == TRUE) ] = 0
    ## Change minor league deal values to 0
  df$TotalValue[ which(grepl(df$TotalValue, pattern = "Minor Lg") == TRUE) ] = 0
    ## Remove dollar signs and commas from value; replace ,s and divide by 1M to display values in terms of millions of dollars
  df$X9 = gsub(df$X9, pattern = "\\$", replacement = "")
  df$X9 = gsub(df$X9, pattern = "\\,", replacement = "")
  df$TotalValue = gsub(df$TotalValue, pattern = "\\$", replacement = "")
  df$TotalValue = gsub(df$TotalValue, pattern = "\\,", replacement = "")
  df$TotalValue = as.numeric(df$TotalValue) / 1000000 ## Data is in Millions of USD
  df$X9 = (as.numeric(df$X9) / as.numeric(df$X7)) / 1000000
  df = add_column(df, Year = "", .before = 2)
  df[,2] = as.numeric(paste("20", Year, sep = ""))
  colnames(df)[c(1,3:7)] = c("Name", "Position", "Age", "Team", "Years", "AAV")
  
  df$Age = as.numeric(df$Age) - (2021 - as.numeric(df$Year) )
  
  for (i in 11:21){
    if ( df$Year == as.numeric(
      paste("20", i, sep = "") )
    ) {
      
    }
  }
  
  assign(paste("ESPN_FA_20", Year, sep = ""), df, envir = .GlobalEnv)
  return(df)
  
}
  ## Create a variable for a selector
ESPN_selector = "#my-players-table"
  ## Loop through and import the data for the relevant time-frame
for ( i in 11:21 ) {
  ESPN_FA_import_fn(Year = i, selector = ESPN_selector)
}
  ## Combine the dfs into one df
ESPN = bind_rows(ESPN_FA_2011, ESPN_FA_2012, ESPN_FA_2013, ESPN_FA_2014, ESPN_FA_2015,
                 ESPN_FA_2016, ESPN_FA_2017, ESPN_FA_2018, ESPN_FA_2019, ESPN_FA_2020,
                 ESPN_FA_2021)
  ## Remove FA deals to Japanese baseball league and "undisclosed" deals
ESPN = ESPN[ -which(ESPN$Team == "Japan"), ]
ESPN = ESPN[ -which(ESPN$Type == "Undisclosed"), ]
rm(ESPN_FA_2011, ESPN_FA_2012, ESPN_FA_2013, ESPN_FA_2014, ESPN_FA_2015, ESPN_FA_2016, ESPN_FA_2017, ESPN_FA_2018, ESPN_FA_2019, ESPN_FA_2020, ESPN_FA_2021)
```

## Scrape and Clean International Signing Data from Spotrac

```{r Scrape and clean Intl Signing Data from Spotrac, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Create a selector from the spotrac website
spotrac_Intl_selector = "#main > div > div.teams > table"
  ## Create a function that will scrape International Signing Data from Spotrac and clean the dataframe
Spotrac_Intl_import_fn = function(Year, spotrac_selector){
  df = read_html(
    paste("https://www.spotrac.com/mlb/international/20", Year, "/", sep = "")
  ) %>% 
    html_element(css = spotrac_selector) %>%
    html_table()
  df = as.data.frame(df)
  colnames(df) = c("Player", "Pos", "Country", "Team", "Bonus")
  df$Bonus = as.numeric(gsub(df$Bonus, pattern = "\\$|\\,", replacement = ""))/1000000
  df$Year = as.numeric(paste("20", Year, sep = ""))
  assign(paste("Intl_Signings_20", Year, sep = ""), df, envir = .GlobalEnv)
}
  ## Loop through the scraping function by the relevant years
for ( i in 11:21 ) {
  Spotrac_Intl_import_fn(Year = i, spotrac_selector = spotrac_Intl_selector)
}
  ## Put all the dfs into one df and remove the separate dfs
IntlALL = rbind.data.frame(Intl_Signings_2011, Intl_Signings_2012, Intl_Signings_2013, Intl_Signings_2014, Intl_Signings_2015,
                           Intl_Signings_2016, Intl_Signings_2017, Intl_Signings_2018, Intl_Signings_2019, Intl_Signings_2020,
                           Intl_Signings_2021)
rm(Intl_Signings_2011, Intl_Signings_2012, Intl_Signings_2013, Intl_Signings_2014, Intl_Signings_2015, Intl_Signings_2016, Intl_Signings_2017, Intl_Signings_2018, Intl_Signings_2019, Intl_Signings_2020, Intl_Signings_2021)
```

## Create and Populate DFs for Plotting

Create dfs

```{r Subsetting Astros and Cubs dfs for plotting, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Remove "Carlos Pena" from Chicago Cubs draft records
BBA_DRAFT_ALL = BBA_DRAFT_ALL[ -which(BBA_DRAFT_ALL$Name == "Carlos Pena"), ]

  ## Remove duplicates
BBA_DRAFT_ALL_no_dup = BBA_DRAFT_ALL[ -which(duplicated(BBA_DRAFT_ALL$Name) == TRUE), ]

  ## Correct Lance McCullers' name
BBA_DRAFT_ALL$Name[ grep(BBA_DRAFT_ALL$Name, pattern = "McCullers") ] = "Lance McCullers Jr."
BBA_DRAFT_ALL_no_dup$Name[ grep(BBA_DRAFT_ALL_no_dup$Name, pattern = "McCullers") ] = "Lance McCullers Jr."

  ## Subset the relevant draft data
ASTROS_CUBS_DRAFT_SUB =
  BBA_DRAFT_ALL_no_dup[ which(BBA_DRAFT_ALL_no_dup$Tm == "Houston Astros" |
                                BBA_DRAFT_ALL_no_dup$Tm == "Chicago Cubs") , ]

LEAGUE_DRAFT_SUB = BBA_DRAFT_ALL_no_dup[ which(BBA_DRAFT_ALL_no_dup$Tm != "Houston Astros" &
                                                 BBA_DRAFT_ALL_no_dup$Tm != "Chicago Cubs"), ]

  ## Join draft subset dfs with career WAR data -> How good drafting was
ASTROS_CUBS_DRAFT_SUB = ASTROS_CUBS_DRAFT_SUB %>%
  left_join(PLAYER_CAREER_WAR)
ASTROS_CUBS_DRAFT_SUB[ -which(ASTROS_CUBS_DRAFT_SUB$Year == 2011), ] %>%
  group_by(Tm) %>%
  summarize(Career_WAR = sum(`Career WAR`, na.rm = T)) %>%
  arrange(desc(Career_WAR))

LEAGUE_DRAFT_SUB = LEAGUE_DRAFT_SUB %>%
  left_join(PLAYER_CAREER_WAR)
Draft_Results = LEAGUE_DRAFT_SUB %>%
  group_by(Tm, Year) %>%
  summarize(Career_WAR = sum(`Career WAR`, na.rm = T)) %>%
  arrange(desc(Career_WAR))

  ## Create subset dfs of standings, value, international signing and free-agent data for the rest of the league
LEAGUE_STAND_SUB = StandALL[ which(StandALL$Tm != "Houston Astros" & StandALL$Tm != "Chicago Cubs"), ]
LEAGUE_VAL_SUB = TeamValALL[ which(TeamValALL$Tm != "Houston Astros" & TeamValALL$Tm != "Chicago Cubs"), ]
LEAGUE_INTL_SUB = IntlALL[ which(IntlALL$Team != "HOU" & IntlALL$Team != "CHC"), ]
LEAGUE_ESPN_SUB = ESPN[ which(ESPN$Team != "Astros" & ESPN$Team != "Cubs"), ]
```

Populate Astros, Cubs, and League "Tanking" dfs

```{r TANK DF filling pt.1, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Create separate dfs for the Cubs and Astros
ASTROS_TANK_DF = matrix(ncol = 18, nrow = length(seq(2011,2021)))
CUBS_TANK_DF = matrix(ncol = 18, nrow = length(seq(2011,2021)))

ASTROS_TANK_DF = as.data.frame(ASTROS_TANK_DF)
CUBS_TANK_DF = as.data.frame(CUBS_TANK_DF)

  ## Create column names
colnames(ASTROS_TANK_DF) = c("Year", "Win%", "# Top 5 picks", "# SS Drafted", "# P Drafted",
                             "# College Draftees", "# Draft Picks", "SS %", "P %", "College %",
                             "# Int'l Signings", "Int'l Signing Money Spent", "# FA Contracts",
                             "Mean FA AAV", "Mean FA Length", "Mean FA Total Value", "Team bWAR",
                             "Team payroll")

colnames(CUBS_TANK_DF) = colnames(ASTROS_TANK_DF)
  ## Create a df for lg avg stats to merge
LG_TANK_DF = matrix(nrow = nrow(ASTROS_TANK_DF), ncol = ncol(ASTROS_TANK_DF))
LG_TANK_DF = as.data.frame(LG_TANK_DF)
colnames(LG_TANK_DF) = colnames(ASTROS_TANK_DF)

  ## Add years
for(i in 1:nrow(ASTROS_TANK_DF)){
  ASTROS_TANK_DF[i,1] = seq(2011,2021)[i]
  CUBS_TANK_DF[i,1] = seq(2011,2021)[i]
  LG_TANK_DF[i,1] = seq(2011,2021)[i]
}

  ## Fill Win %
ASTROS_TANK_DF[,2] = StandALL$`W-L%`[ which(StandALL$Tm == "Houston Astros") ]
CUBS_TANK_DF[,2] = StandALL$`W-L%`[ which(StandALL$Tm == "Chicago Cubs") ]
LG_TANK_DF$`Win%` = 0.500
```

Fill # of picks in First 5 rds

```{r TANK DF filling draft picks 1, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
  ## Fill # of Picks in First 5 rds
ASTROS_TANK_DF[1,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" &
                                       ASTROS_CUBS_DRAFT_SUB$Year == 2011 &
                                       ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
```

Repeat for rest, for `CUBS_TANK_DF` and `LG_TANK_DF` (not shown)

```{r TANK DF filling draft picks 2, include = TRUE, warning = FALSE, echo = FALSE, message = FALSE}
ASTROS_TANK_DF[2,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[3,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[4,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[5,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[6,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[7,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[8,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[9,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[10,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
ASTROS_TANK_DF[11,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )

CUBS_TANK_DF[1,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[2,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[3,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[4,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[5,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[6,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[7,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[8,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[9,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[10,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )
CUBS_TANK_DF[11,3] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$Rd <= 5 ) )

LG_TANK_DF[1,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2011 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[2,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2012 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[3,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2013 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[4,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2014 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[5,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2015 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[6,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2016 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[7,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2017 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[8,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2018 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[9,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2019 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[10,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2020 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
LG_TANK_DF[11,3] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2021 & LEAGUE_DRAFT_SUB$Rd <= 5 ) ) / 28, digits = 2)
```
Fill # SSs drafted

```{r TANK DF filling SSs 1, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
## Fill # of SSs drafted
ASTROS_TANK_DF[1,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" &
                                       ASTROS_CUBS_DRAFT_SUB$Year == 2011 &
                                       ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
```

Repeat for rest, for `CUBS_TANK_DF` and `LG_TANK_DF` (not shown)

```{r TANK DF filling SSs 2, include = TRUE, warning = FALSE, echo = FALSE, message = FALSE}
ASTROS_TANK_DF[2,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[3,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[4,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[5,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[6,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[7,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[8,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[9,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[10,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
ASTROS_TANK_DF[11,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )

CUBS_TANK_DF[1,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[2,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[3,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[4,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[5,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[6,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[7,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[8,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[9,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[10,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )
CUBS_TANK_DF[11,4] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$POS == "SS" ) )

LG_TANK_DF[1,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2011 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[2,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2012 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[3,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2013 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[4,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2014 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[5,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2015 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[6,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2016 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[7,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2017 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[8,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2018 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[9,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2019 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[10,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2020 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
LG_TANK_DF[11,4] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2021 & LEAGUE_DRAFT_SUB$POS == "SS" ) ) / 28, digits = 2)
```

Populate the rest of the dfs (not shown)

```{r TANK DF filling, include = TRUE, warning = FALSE, echo = FALSE, message = FALSE}
## Fill # of Ps drafted
ASTROS_TANK_DF[1,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[2,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[3,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[4,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[5,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[6,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
ASTROS_TANK_DF[7,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2017)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2017)], pattern = "RHP|LHP")] )
ASTROS_TANK_DF[8,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2018)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2018)], pattern = "RHP|LHP")] )
ASTROS_TANK_DF[9,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2019)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2019)], pattern = "RHP|LHP")] )
ASTROS_TANK_DF[10,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2020)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2020)], pattern = "RHP|LHP")] )
ASTROS_TANK_DF[11,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2021)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros" & ASTROS_CUBS_DRAFT_SUB$Year == 2021)], pattern = "RHP|LHP")] )

CUBS_TANK_DF[1,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[2,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[3,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[4,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[5,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[6,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$POS == "P" ) )
CUBS_TANK_DF[7,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2017)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2017)], pattern = "RHP|LHP")] )
CUBS_TANK_DF[8,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2018)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2018)], pattern = "RHP|LHP")] )
CUBS_TANK_DF[9,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2019)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2019)], pattern = "RHP|LHP")] )
CUBS_TANK_DF[10,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2020)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2020)], pattern = "RHP|LHP")] )
CUBS_TANK_DF[11,5] = length( which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2021)[grep(ASTROS_CUBS_DRAFT_SUB$POS[which( ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs" & ASTROS_CUBS_DRAFT_SUB$Year == 2021)], pattern = "RHP|LHP")] )

LG_TANK_DF[1,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2011 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[2,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2012 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[3,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2013 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[4,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2014 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[5,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2015 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[6,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2016 & LEAGUE_DRAFT_SUB$POS == "P") ) / 28, digits = 2)
LG_TANK_DF[7,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2017 & LEAGUE_DRAFT_SUB$POS == "P")[grep(LEAGUE_DRAFT_SUB$POS[which( LEAGUE_DRAFT_SUB$Year== 2017)], pattern = "RHP|LHP")] ) / 28, digits = 2)
LG_TANK_DF[8,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2018 & LEAGUE_DRAFT_SUB$POS == "P")[grep(LEAGUE_DRAFT_SUB$POS[which( LEAGUE_DRAFT_SUB$Year== 2018)], pattern = "RHP|LHP")] ) / 28, digits = 2)
LG_TANK_DF[9,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2019 & LEAGUE_DRAFT_SUB$POS == "P")[grep(LEAGUE_DRAFT_SUB$POS[which( LEAGUE_DRAFT_SUB$Year== 2019)], pattern = "RHP|LHP")] ) / 28, digits = 2)
LG_TANK_DF[10,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2020 & LEAGUE_DRAFT_SUB$POS == "P")[grep(LEAGUE_DRAFT_SUB$POS[which( LEAGUE_DRAFT_SUB$Year== 2020)], pattern = "RHP|LHP")] ) / 28, digits = 2)
LG_TANK_DF[11,5] = round(length( which( LEAGUE_DRAFT_SUB$Year == 2021 & LEAGUE_DRAFT_SUB$POS == "P")[grep(LEAGUE_DRAFT_SUB$POS[which( LEAGUE_DRAFT_SUB$Year== 2021)], pattern = "RHP|LHP")] ) / 28, digits = 2)

## Fill # of College Picks
ASTROS_TANK_DF[1,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2011 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[2,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2012 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[3,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2013 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[4,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2014 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[5,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2015 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[6,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2016 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[7,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2017 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[8,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2018 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[9,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2019 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[10,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2020 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
ASTROS_TANK_DF[11,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2021 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))

CUBS_TANK_DF[1,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2011 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[2,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2012 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[3,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2013 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[4,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2014 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[5,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2015 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[6,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2016 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[7,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2017 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[8,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2018 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[9,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2019 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[10,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2020 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))
CUBS_TANK_DF[11,6] = length(which(
  grepl(ASTROS_CUBS_DRAFT_SUB$`Drafted From`[ which( ASTROS_CUBS_DRAFT_SUB$Year == 2021 &  ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs")], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE))

LG_TANK_DF[1,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2011 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[2,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2012 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[3,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2013 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[4,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2014 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[5,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2015 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[6,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2016 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[7,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2017 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[8,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2018 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[9,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2019 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[10,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2020 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)
LG_TANK_DF[11,6] = round(length(which(
  grepl(LEAGUE_DRAFT_SUB$`Drafted From`[ which( LEAGUE_DRAFT_SUB$Year == 2021 )], pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC") == TRUE)) / 28, digits = 2)

## Fill Total # Picks
ASTROS_TANK_DF[1,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[2,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[3,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[4,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[5,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[6,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[7,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[8,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[9,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[10,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))
ASTROS_TANK_DF[11,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$Tm == "Houston Astros"))

CUBS_TANK_DF[1,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2011 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[2,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2012 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[3,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2013 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[4,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2014 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[5,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2015 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[6,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2016 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[7,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2017 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[8,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2018 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[9,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2019 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[10,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2020 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))
CUBS_TANK_DF[11,7] = length(which(ASTROS_CUBS_DRAFT_SUB$Year == 2021 & ASTROS_CUBS_DRAFT_SUB$Tm == "Chicago Cubs"))

LG_TANK_DF[1,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2011)) / 28, digits = 2)
LG_TANK_DF[2,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2012)) / 28, digits = 2)
LG_TANK_DF[3,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2013)) / 28, digits = 2)
LG_TANK_DF[4,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2014)) / 28, digits = 2)
LG_TANK_DF[5,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2015)) / 28, digits = 2)
LG_TANK_DF[6,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2016)) / 28, digits = 2)
LG_TANK_DF[7,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2017)) / 28, digits = 2)
LG_TANK_DF[8,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2018)) / 28, digits = 2)
LG_TANK_DF[9,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2019)) / 28, digits = 2)
LG_TANK_DF[10,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2020)) / 28, digits = 2)
LG_TANK_DF[11,7] = round(length(which(LEAGUE_DRAFT_SUB$Year == 2021)) / 28, digits = 2)

## Fill % of picks on SSs
ASTROS_TANK_DF[,8] = round((ASTROS_TANK_DF[,4] / ASTROS_TANK_DF[,7])*100, digits = 2)
CUBS_TANK_DF[,8] = round((CUBS_TANK_DF[,4] / CUBS_TANK_DF[,7])*100, digits = 2)
LG_TANK_DF[,8] = round((LG_TANK_DF[,4] / LG_TANK_DF[,7])*100, digits = 2)
## Fill % of picks on Ps
ASTROS_TANK_DF[,9] = round((ASTROS_TANK_DF[,5] / ASTROS_TANK_DF[,7])*100, digits = 2)
CUBS_TANK_DF[,9] = round((CUBS_TANK_DF[,5] / CUBS_TANK_DF[,7])*100, digits = 2)
LG_TANK_DF[,9] = round((LG_TANK_DF[,5] / LG_TANK_DF[,7])*100, digits = 2)
## Fill % of picks on college players
ASTROS_TANK_DF[,10] = round((ASTROS_TANK_DF[,6] / ASTROS_TANK_DF[,7])*100, digits = 2)
CUBS_TANK_DF[,10] = round((CUBS_TANK_DF[,6] / CUBS_TANK_DF[,7])*100, digits = 2)
LG_TANK_DF[,10] = round((LG_TANK_DF[,6] / LG_TANK_DF[,7])*100, digits = 2)

## How many Int'l FAs
ASTROS_TANK_DF[1,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2011))
ASTROS_TANK_DF[2,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2012))
ASTROS_TANK_DF[3,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2013))
ASTROS_TANK_DF[4,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2014))
ASTROS_TANK_DF[5,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2015))
ASTROS_TANK_DF[6,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2016))
ASTROS_TANK_DF[7,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2017))
ASTROS_TANK_DF[8,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2018))
ASTROS_TANK_DF[9,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2019))
ASTROS_TANK_DF[10,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2020))
ASTROS_TANK_DF[11,11] = length(which(IntlALL$Team == "HOU" & IntlALL$Year == 2021))

CUBS_TANK_DF[1,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2011))
CUBS_TANK_DF[2,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2012))
CUBS_TANK_DF[3,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2013))
CUBS_TANK_DF[4,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2014))
CUBS_TANK_DF[5,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2015))
CUBS_TANK_DF[6,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2016))
CUBS_TANK_DF[7,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2017))
CUBS_TANK_DF[8,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2018))
CUBS_TANK_DF[9,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2019))
CUBS_TANK_DF[10,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2020))
CUBS_TANK_DF[11,11] = length(which(IntlALL$Team == "CHC" & IntlALL$Year == 2021))

LG_TANK_DF[1,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2011))/ 28, digits = 2)
LG_TANK_DF[2,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2012))/ 28, digits = 2)
LG_TANK_DF[3,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2013))/ 28, digits = 2)
LG_TANK_DF[4,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2014))/ 28, digits = 2)
LG_TANK_DF[5,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2015))/ 28, digits = 2)
LG_TANK_DF[6,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2016))/ 28, digits = 2)
LG_TANK_DF[7,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2017))/ 28, digits = 2)
LG_TANK_DF[8,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2018))/ 28, digits = 2)
LG_TANK_DF[9,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2019))/ 28, digits = 2)
LG_TANK_DF[10,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2020))/ 28, digits = 2)
LG_TANK_DF[11,11] = round(length(which(LEAGUE_INTL_SUB$Year == 2021))/ 28, digits = 2)

## Total Spent on Int'l FAs
ASTROS_TANK_DF[1,12] = 0#sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2011)])
ASTROS_TANK_DF[2,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2012)], na.rm = T)
ASTROS_TANK_DF[3,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2013)], na.rm = T)
ASTROS_TANK_DF[4,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2014)], na.rm = T)
ASTROS_TANK_DF[5,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2015)], na.rm = T)
ASTROS_TANK_DF[6,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2016)], na.rm = T)
ASTROS_TANK_DF[7,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2017)], na.rm = T)
ASTROS_TANK_DF[8,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2018)], na.rm = T)
ASTROS_TANK_DF[9,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2019)], na.rm = T)
ASTROS_TANK_DF[10,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2020)], na.rm = T)
ASTROS_TANK_DF[11,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "HOU" & IntlALL$Year == 2021)], na.rm = T)

CUBS_TANK_DF[1,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2011)], na.rm = T)
CUBS_TANK_DF[2,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2012)], na.rm = T)
CUBS_TANK_DF[3,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2013)], na.rm = T)
CUBS_TANK_DF[4,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2014)], na.rm = T)
CUBS_TANK_DF[5,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2015)], na.rm = T)
CUBS_TANK_DF[6,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2016)], na.rm = T)
CUBS_TANK_DF[7,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2017)], na.rm = T)
CUBS_TANK_DF[8,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2018)], na.rm = T)
CUBS_TANK_DF[9,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2019)], na.rm = T)
CUBS_TANK_DF[10,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2020)], na.rm = T)
CUBS_TANK_DF[11,12] = sum(IntlALL$Bonus[which(IntlALL$Team == "CHC" & IntlALL$Year == 2021)], na.rm = T)

LG_TANK_DF[1,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2011)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[2,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2012)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[3,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2013)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[4,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2014)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[5,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2015)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[6,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2016)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[7,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2017)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[8,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2018)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[9,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2019)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[10,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2020)], na.rm = T) / 28, digits = 3)
LG_TANK_DF[11,12] = round(sum(LEAGUE_INTL_SUB$Bonus[ which(LEAGUE_INTL_SUB$Year == 2021)], na.rm = T) / 28, digits = 3)

## Fill FA signing data
## Number of contracts
ASTROS_TANK_DF[1,13] = length(which(ESPN$Year == 2011 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[2,13] = length(which(ESPN$Year == 2012 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[3,13] = length(which(ESPN$Year == 2013 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[4,13] = length(which(ESPN$Year == 2014 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[5,13] = length(which(ESPN$Year == 2015 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[6,13] = length(which(ESPN$Year == 2016 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[7,13] = length(which(ESPN$Year == 2017 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[8,13] = length(which(ESPN$Year == 2018 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[9,13] = length(which(ESPN$Year == 2019 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[10,13] = length(which(ESPN$Year == 2020 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))
ASTROS_TANK_DF[11,13] = length(which(ESPN$Year == 2021 & ESPN$Team == "Astros" & ESPN$Type == "MLB"))

CUBS_TANK_DF[1,13] = length(which(ESPN$Year == 2011 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[2,13] = length(which(ESPN$Year == 2012 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[3,13] = length(which(ESPN$Year == 2013 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[4,13] = length(which(ESPN$Year == 2014 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[5,13] = length(which(ESPN$Year == 2015 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[6,13] = length(which(ESPN$Year == 2016 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[7,13] = length(which(ESPN$Year == 2017 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[8,13] = length(which(ESPN$Year == 2018 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[9,13] = length(which(ESPN$Year == 2019 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[10,13] = length(which(ESPN$Year == 2020 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))
CUBS_TANK_DF[11,13] = length(which(ESPN$Year == 2021 & ESPN$Team == "Cubs" & ESPN$Type == "MLB"))

LG_TANK_DF[1,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2011 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[2,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2012 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[3,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2013 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[4,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2014 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[5,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2015 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[6,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2016 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[7,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2017 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[8,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2018 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[9,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2019 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[10,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2020 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)
LG_TANK_DF[11,13] = round(length(which(LEAGUE_ESPN_SUB$Year == 2021 & LEAGUE_ESPN_SUB$Type == "MLB"))/28, digits = 2)

## Mean AAV of FA contracts
ASTROS_TANK_DF[1,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2011 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[2,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2012 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[3,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2013 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[4,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2014 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[5,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2015 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[6,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2016 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[7,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2017 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[8,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2018 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[9,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2019 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[10,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2020 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[11,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2021 & ESPN$Team == "Astros") ], na.rm = TRUE), digits = 3)

CUBS_TANK_DF[1,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2011 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[2,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2012 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[3,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2013 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[4,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2014 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[5,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2015 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[6,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2016 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[7,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2017 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[8,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2018 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[9,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2019 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[10,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2020 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[11,14] = round(mean(ESPN$AAV[ which(ESPN$Year == 2021 & ESPN$Team == "Cubs") ], na.rm = TRUE), digits = 3)

LG_TANK_DF[1,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2011) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[2,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2012) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[3,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2013) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[4,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2014) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[5,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2015) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[6,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2016) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[7,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2017) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[8,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2018) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[9,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2019) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[10,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2020) ], na.rm = TRUE), digits = 3)
LG_TANK_DF[11,14] = round(mean(LEAGUE_ESPN_SUB$AAV[ which(LEAGUE_ESPN_SUB$Year == 2021) ], na.rm = TRUE), digits = 3)

## Mean Length of FA contracts
ASTROS_TANK_DF[1,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2011 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[2,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2012 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[3,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2013 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[4,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2014 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[5,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2015 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[6,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2016 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[7,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2017 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[8,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2018 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[9,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2019 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[10,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2020 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
ASTROS_TANK_DF[11,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2021 & ESPN$Team == "Astros" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)

CUBS_TANK_DF[1,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2011 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[2,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2012 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[3,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2013 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[4,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2014 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[5,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2015 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[6,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2016 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[7,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2017 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[8,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2018 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[9,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2019 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[10,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2020 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)
CUBS_TANK_DF[11,15] = round(mean(as.numeric(ESPN$Years[ which(ESPN$Year == 2021 & ESPN$Team == "Cubs" & ESPN$Years != "") ]), na.rm = TRUE), digits = 2)

LG_TANK_DF[1,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2011 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[2,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2012 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[3,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2013 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[4,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2014 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[5,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2015 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[6,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2016 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[7,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2017 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[8,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2018 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[9,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2019 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[10,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2020 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)
LG_TANK_DF[11,15] = round(mean(as.numeric(LEAGUE_ESPN_SUB$Years[ which(LEAGUE_ESPN_SUB$Year == 2021 & LEAGUE_ESPN_SUB$Years != "") ]), na.rm = TRUE), digits = 2)

## Mean Total Value of FA contracts
ASTROS_TANK_DF[1,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2011 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[2,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2012 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[3,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2013 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[4,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2014 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[5,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2015 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[6,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2016 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[7,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2017 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[8,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2018 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[9,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2019 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[10,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2020 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
ASTROS_TANK_DF[11,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2021 & ESPN$Team == "Astros" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)

CUBS_TANK_DF[1,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2011 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[2,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2012 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[3,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2013 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[4,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2014 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[5,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2015 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[6,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2016 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[7,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2017 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[8,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2018 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[9,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2019 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[10,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2020 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)
CUBS_TANK_DF[11,16] = round(mean(ESPN$TotalValue[ which(ESPN$Year == 2021 & ESPN$Team == "Cubs" & ESPN$Years != "") ], na.rm = TRUE), digits = 3)

LG_TANK_DF[1,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2011 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[2,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2012 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[3,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2013 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[4,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2014 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[5,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2015 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[6,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2016 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[7,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2017 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[8,16] = round(median(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2018 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[9,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2019 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[10,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2020 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)
LG_TANK_DF[11,16] = round(mean(LEAGUE_ESPN_SUB$TotalValue[ which(LEAGUE_ESPN_SUB$Year == 2021 & LEAGUE_ESPN_SUB$Years != "") ], na.rm = TRUE), digits = 3)


## Team bWAR
ASTROS_TANK_DF[1,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2011)], digits = 1)
ASTROS_TANK_DF[2,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2012)], digits = 1)
ASTROS_TANK_DF[3,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2013)], digits = 1)
ASTROS_TANK_DF[4,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2014)], digits = 1)
ASTROS_TANK_DF[5,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2015)], digits = 1)
ASTROS_TANK_DF[6,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2016)], digits = 1)
ASTROS_TANK_DF[7,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2017)], digits = 1)
ASTROS_TANK_DF[8,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2018)], digits = 1)
ASTROS_TANK_DF[9,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2019)], digits = 1)
ASTROS_TANK_DF[10,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2020)], digits = 1)
ASTROS_TANK_DF[11,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2021)], digits = 1)

CUBS_TANK_DF[1,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2011)], digits = 1)
CUBS_TANK_DF[2,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2012)], digits = 1)
CUBS_TANK_DF[3,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2013)], digits = 1)
CUBS_TANK_DF[4,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2014)], digits = 1)
CUBS_TANK_DF[5,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2015)], digits = 1)
CUBS_TANK_DF[6,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2016)], digits = 1)
CUBS_TANK_DF[7,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2017)], digits = 1)
CUBS_TANK_DF[8,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2018)], digits = 1)
CUBS_TANK_DF[9,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2019)], digits = 1)
CUBS_TANK_DF[10,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2020)], digits = 1)
CUBS_TANK_DF[11,17] = round(TeamValALL$WAR[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2021)], digits = 1)

LG_TANK_DF[1,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2011) ]), digits = 1)
LG_TANK_DF[2,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2012) ]), digits = 1)
LG_TANK_DF[3,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2013) ]), digits = 1)
LG_TANK_DF[4,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2014) ]), digits = 1)
LG_TANK_DF[5,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2015) ]), digits = 1)
LG_TANK_DF[6,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2016) ]), digits = 1)
LG_TANK_DF[7,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2017) ]), digits = 1)
LG_TANK_DF[8,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2018) ]), digits = 1)
LG_TANK_DF[9,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2019) ]), digits = 1)
LG_TANK_DF[10,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2020) ]), digits = 1)
LG_TANK_DF[11,17] = round(median(LEAGUE_VAL_SUB$WAR[ which(LEAGUE_VAL_SUB$Year == 2021) ]), digits = 1)

## Team Sal (payroll)
ASTROS_TANK_DF[1,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2011)], digits = 3)
ASTROS_TANK_DF[2,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2012)], digits = 3)
ASTROS_TANK_DF[3,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2013)], digits = 3)
ASTROS_TANK_DF[4,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2014)], digits = 3)
ASTROS_TANK_DF[5,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2015)], digits = 3)
ASTROS_TANK_DF[6,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2016)], digits = 3)
ASTROS_TANK_DF[7,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2017)], digits = 3)
ASTROS_TANK_DF[8,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2018)], digits = 3)
ASTROS_TANK_DF[9,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2019)], digits = 3)
ASTROS_TANK_DF[10,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2020)], digits = 3)
ASTROS_TANK_DF[11,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Houston Astros" & TeamValALL$Year == 2021)], digits = 3)

CUBS_TANK_DF[1,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2011)], digits = 3)
CUBS_TANK_DF[2,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2012)], digits = 3)
CUBS_TANK_DF[3,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2013)], digits = 3)
CUBS_TANK_DF[4,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2014)], digits = 3)
CUBS_TANK_DF[5,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2015)], digits = 3)
CUBS_TANK_DF[6,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2016)], digits = 3)
CUBS_TANK_DF[7,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2017)], digits = 3)
CUBS_TANK_DF[8,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2018)], digits = 3)
CUBS_TANK_DF[9,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2019)], digits = 3)
CUBS_TANK_DF[10,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2020)], digits = 3)
CUBS_TANK_DF[11,18] = round(TeamValALL$Salary[ which(TeamValALL$Tm == "Chicago Cubs" & TeamValALL$Year == 2021)], digits = 3)

LG_TANK_DF[1,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2011)]), digits = 3)
LG_TANK_DF[2,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2012)]), digits = 3)
LG_TANK_DF[3,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2013)]), digits = 3)
LG_TANK_DF[4,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2014)]), digits = 3)
LG_TANK_DF[5,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2015)]), digits = 3)
LG_TANK_DF[6,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2016)]), digits = 3)
LG_TANK_DF[7,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2017)]), digits = 3)
LG_TANK_DF[8,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2018)]), digits = 3)
LG_TANK_DF[9,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2019)]), digits = 3)
LG_TANK_DF[10,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2020)]), digits = 3)
LG_TANK_DF[11,18] = round(median(LEAGUE_VAL_SUB$Salary[ which(LEAGUE_VAL_SUB$Year == 2021)]), digits = 3)

```

Add career bWAR of draftees to the dfs

```{r Merge TANK DFs, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
## Add Career WAR of draftees
ASTROS_TANK_DF = ASTROS_CUBS_DRAFT_SUB %>%
  group_by(Year) %>%
  filter(Tm == "Houston Astros") %>%
  summarize(Draft_Class_Career_WAR = sum(`Career WAR`, na.rm = T)) %>%
  select(Draft_Class_Career_WAR) %>%
  bind_cols(ASTROS_TANK_DF)
ASTROS_TANK_DF = ASTROS_TANK_DF %>%
  relocate(Draft_Class_Career_WAR, .after = 19)

CUBS_TANK_DF = ASTROS_CUBS_DRAFT_SUB %>%
  group_by(Year) %>%
  filter(Tm == "Chicago Cubs") %>%
  summarize(Draft_Class_Career_WAR = sum(`Career WAR`, na.rm = T)) %>%
  select(Draft_Class_Career_WAR) %>%
  bind_cols(CUBS_TANK_DF)
CUBS_TANK_DF = CUBS_TANK_DF %>%
    relocate(Draft_Class_Career_WAR, .after = 19)

LG_TANK_DF = LEAGUE_DRAFT_SUB %>%
  group_by(Year) %>%
  summarize(Draft_Class_Career_WAR = sum(`Career WAR`, na.rm = T)/28) %>%
  select(Draft_Class_Career_WAR) %>%
  bind_cols(LG_TANK_DF)
LG_TANK_DF = LG_TANK_DF %>%
  relocate(Draft_Class_Career_WAR, .after = 19)
LG_TANK_DF[ , 19] = round(LG_TANK_DF[ , 19], digits = 1)
  
## Add "WARPM" (WAR Per Million $) col
ASTROS_TANK_DF$WARPM = round(ASTROS_TANK_DF$`Team bWAR` / ASTROS_TANK_DF$`Team payroll`, digits = 2)
CUBS_TANK_DF$WARPM = round(CUBS_TANK_DF$`Team bWAR` / CUBS_TANK_DF$`Team payroll`, digits = 2)
LG_TANK_DF$WARPM = round(LG_TANK_DF$`Team bWAR` / LG_TANK_DF$`Team payroll`, digits = 2)

## Add Team col
ASTROS_TANK_DF$Tm = "Houston Astros"
CUBS_TANK_DF$Tm = "Chicago Cubs"
LG_TANK_DF$Tm = "LeagueAVG"
TANK_DF = rbind.data.frame(ASTROS_TANK_DF, CUBS_TANK_DF, LG_TANK_DF)
```

## Create and Clean the df for Tankers

```{r REBUILDERS_df and plotly creation, include = TRUE, warning = FALSE, echo = TRUE, message = FALSE}
REBUILDERS_df = TeamValALL %>%
  group_by(`Tm`, Year) %>%
  filter(L >= 92)

  ## Remove the Red Sox, Indians/Guardians, Brewers, Mets, Giants, Rays, Jays, Nats (idx = 5, 7, 23, 35, 40, 30, 52, 58)
REBUILDERS_df = REBUILDERS_df[ -c(5, 7, 23, 35, 40, 30, 52, 58), ]

REBUILDERS_df = REBUILDERS_df %>%
  group_by(`Tm`, Year) %>%
  arrange(`Tm`, Year) %>%
  ungroup()

REBUILDERS_df$GB = as.double(REBUILDERS_df$GB)
colnames(REBUILDERS_df)[c(8:13)] = c("MLB Trades Made", "FA Signings", "Minors Callups", "Payroll Sum", "bWAR", "Payroll (in M $US)")
head(REBUILDERS_df[c(4,5,7:11,13:16,20:27,31:38,41,42,45,46,52:54),-11])

  ## Remove non-qualifiers
Printable_REBUILD = REBUILDERS_df[c(4,5,7:11,13:16,20:27,31:38,41,42,45,46),-11]

  ## Re-arrange for display
Printable_REBUILD = Printable_REBUILD %>%
  select(`Tm`, Year, W, L, W_L, GB, DivRank, `MLB Trades Made`, `FA Signings`, `Minors Callups`, bWAR, `Payroll (in M $US)`)

  ## For plotting
Rebuild_T = plot_ly(
  type = 'table',
  columnwidth = c(rep(20,12)),
  columnorder = c(seq(1,12,1)),
  header = list(
    values = c(colnames(Printable_REBUILD)),
    align = c("center", "center"),
    line = list(width = 1, color = 'black'),
    fill = list(color = c("grey", "grey")),
    font = list(family = "Times", size = 14, color = "black")
  ),
  cells = list(
    values = rbind(Printable_REBUILD$Tm,
                   Printable_REBUILD$Year,
                   Printable_REBUILD$W,
                   Printable_REBUILD$L,
                   Printable_REBUILD$W_L,
                   Printable_REBUILD$GB,
                   Printable_REBUILD$DivRank,
                   Printable_REBUILD$`MLB Trades Made`,
                   Printable_REBUILD$`FA Signings`,
                   Printable_REBUILD$`Minors Callups`,
                   Printable_REBUILD$bWAR,
                   Printable_REBUILD$`Payroll (in M $US)`),
    align = c("center", "center"),
    line = list(color = "black", width = 1),
    font = list(family = "Times", size = 12, color = c("black"))
  ))
```
