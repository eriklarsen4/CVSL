dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Shed Long") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Shed Long")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Riddle") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "JT Riddle")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Locastro") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Locastro")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Granite") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Granite")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Edwin Diaz") &
grepl(Tm, pattern = "Oak") ~ NA,
grepl(Name, pattern = "Greg Harris") ~ NA,
grepl(Name, pattern = "John Farrell") ~ NA,
grepl(Name, pattern = "Mark Leiter") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Mark Leiter")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Mauricio Dubon") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Mauricio Dub")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Matt Young") &
grepl(Tm, pattern = "Miami") ~ NA,
grepl(Name, pattern = "Jake Miller") &
grepl(Tm, pattern = "Arizona") ~ NA,
grepl(Name, pattern = "Torii Hunter") ~ NA,
grepl(Name, pattern = "Frank Duncan") ~ NA,
grepl(Name, pattern = "Brent Honeywell") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Honeywell")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Troy Stokes") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Troy Stokes")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Brian Hunter") ~ NA,
grepl(key_bbref, pattern = "kellypa01") ~ NA,
grepl(Name, pattern = "Mike Fitzgerald") ~ NA,
grepl(Name, pattern = "Mariano Rivera") ~ NA,
grepl(Name, pattern = "Benito Santiago") ~ NA,
grepl(Name, pattern = "Soroka") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Soroka")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Chad Smith") &
grepl(Tm, pattern = "Rangers") ~ NA,
grepl(Name, pattern = "Pete Fairbanks") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Pete Fairbanks")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(key_bbref, pattern = "brownke04") &
grepl(Tm, pattern = "Dodgers") &
Year == 2015 ~ NA,
grepl(Name, pattern = "Jeremey Pena") ~ CHAD_LU %>%
dplyr::filter(key_bbref == "penaje02") %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Michael King") ~ CHAD_LU %>%
dplyr::filter(key_bbref == "kingmi01") %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Andrew Brown") &
grepl(Tm, pattern = "Phillies") ~ NA,
grepl(Name, pattern = "Nate Lowe") ~ CHAD_LU %>%
dplyr::filter(key_bbref == "lowena01") %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Blake Smith") ~ NA,
grepl(bbref_id, pattern = "wilsojo02") ~ NA,
grepl(Name, pattern = "Josh Smith") &
grepl(Tm, pattern = "Tigers") ~ CHAD_LU %>%
dplyr::filter(key_bbref == "smithjo11") %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Bleday") &
name_last == "Bleday" ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Bleday")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "John Russell") ~ NA,
grepl(Name, pattern = "Logan Allen") &
Year == 2017 ~ CHAD_LU %>%
dplyr::filter(key_bbref == "allenlo02") %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Julio Gonzalez") ~ NA,
grepl(Name, pattern = "Andrew Miller") ~ NA,
grepl(Name, pattern = "Dave Smith") ~ NA,
grepl(Name, pattern = "Bill Sullivan") ~ NA,
grepl(Name, pattern = "Eduoard Julien") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Edouard Julien")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(key_bbref, pattern = "smithja03") ~ NA,
grepl(key_bbref, pattern = "gonzaed02") ~ NA,
grepl(Name, pattern = "Luis Gonzalez") &
grepl(Tm, pattern = "Brewers") ~ NA,
grepl(Name, pattern = "George Bell") ~ NA,
grepl(Name, pattern = "Jake Smith") &
Year == 2018 ~ NA,
grepl(Name, pattern = "Josh Smith") &
grepl(Tm, pattern = "Texas Rangers") &
Year == 2018 ~ NA,
grepl(Name, pattern = "Luis Lopez") ~ NA,
grepl(Name, pattern = "Benito Santiago") &
Year == 2018 ~ NA,
grepl(Name, pattern = "Andrew Miller") &
Year == 2018 ~ NA,
grepl(Name, pattern = "Bobby Witt") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Bobby Witt") &
name_suffix == "Jr.") %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "C.J. Abrams") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "CJ Abrams")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Josh Smith") &
grepl(Tm, pattern = "Yankees") ~ NA,
grepl(Name, pattern = "Logan Allen") &
grepl(Tm, pattern = "Rays") ~ NA,
grepl(Name, pattern = "Edouard Julien") &
grepl(Tm, pattern = "Twins") ~ CHAD_LU %>%
dplyr::filter(grepl(Name, pattern = "Eduoard Julien")) %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Logan Allen") &
grepl(Tm, pattern = "Cleveland") ~ CHAD_LU %>%
dplyr::filter(key_bbref == "allenlo02") %>%
dplyr::select(key_bbref) %>%
as.character(),
grepl(Name, pattern = "Max Muncy") &
Year == 2021 ~ NA,
grepl(Name, pattern = "Jake Smith") &
grepl(Tm, pattern = "Angels") ~ NA,
grepl(Name, pattern = "Ben Harris") &
grepl(Tm, pattern = "Dodgers") ~ NA,
grepl(Name, pattern = "Johnny Ray") &
grepl(Tm, pattern = "White Sox") ~ NA,
grepl(Name, pattern = "Juan Gonzalez") &
Year == 2021 ~ NA,
grepl(Name, pattern = "Jake Miller") &
grepl(Tm, pattern = "Cleveland") ~ NA,
TRUE ~ bbref_id))
## Join draft subset dfs with career WAR data -> How good drafting was
ASTROS_CUBS_DRAFT_SUB = ASTROS_CUBS_DRAFT_SUB %>%
dplyr::select(-key_bbref) %>%
left_join(CAREER_WAR_df, by = "bbref_id") %>%
dplyr::select(-name_last, -name_first, -name_first,
-name_given, -name_suffix, -name_matrilineal, -name_nick,
-contains("key"), -contains("played")) %>%
dplyr::mutate(Name = Name.x, .after = 7) %>%
dplyr::select(-Name.x, -Name.y)
ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Year != "2011") %>%
dplyr::group_by(Tm) %>%
dplyr::summarize(Career_bWAR = sum(Career_bWAR, na.rm = T)) %>%
dplyr::arrange(desc(Career_bWAR))
LEAGUE_DRAFT_SUB = LEAGUE_DRAFT_SUB %>%
dplyr::select(-key_bbref) %>%
left_join(CAREER_WAR_df, by = "bbref_id") %>%
dplyr::select(-name_last, -name_first, -name_first,
-name_given, -name_suffix, -name_matrilineal, -name_nick,
-contains("key"), -contains("played")) %>%
dplyr::mutate(Name = Name.x, .after = 7) %>%
dplyr::select(-Name.x, -Name.y)
options(scipen = 999)
Draft_Results = LEAGUE_DRAFT_SUB %>%
dplyr::filter(Year > 2011) %>%
dplyr::group_by(Tm, Year) %>%
summarize(Career_bWAR = round(sum(Career_bWAR, na.rm = T),1)) %>%
dplyr::arrange(desc(Career_bWAR))
## Create subset dfs of standings, value, international signing and free-agent data for the rest of the league
LEAGUE_STAND_SUB = StandALL[ which(StandALL$Tm != "Houston Astros" & StandALL$Tm != "Chicago Cubs"), ]
LEAGUE_VAL_SUB = TeamValALL[ which(TeamValALL$Tm != "Houston Astros" & TeamValALL$Tm != "Chicago Cubs"), ]
LEAGUE_INTL_SUB = IntlALL[ which(IntlALL$Team != "HOU" & IntlALL$Team != "CHC"), ]
LEAGUE_ESPN_SUB = ESPN[ which(ESPN$Team != "Astros" & ESPN$Team != "Cubs"), ]
## Create separate dfs for the Cubs and Astros
ASTROS_TANK_DF = matrix(ncol = 18, nrow = length(seq(2011,2021)))
CUBS_TANK_DF = matrix(ncol = 18, nrow = length(seq(2011,2021)))
ASTROS_TANK_DF = as.data.frame(ASTROS_TANK_DF)
CUBS_TANK_DF = as.data.frame(CUBS_TANK_DF)
## Create column names
colnames(ASTROS_TANK_DF) = c("Year", "Win%", "# Top 5 picks", "# SS Drafted", "# P Drafted",
"# College Draftees", "# Draft Picks", "SS %", "P %", "College %",
"# Int'l Signings", "Int'l Signing Money Spent", "# FA Contracts",
"Mean FA AAV", "Mean FA Length", "Mean FA Total Value", "Team bWAR",
"Team payroll")
colnames(CUBS_TANK_DF) = colnames(ASTROS_TANK_DF)
## Create a df for lg avg stats to merge
LG_TANK_DF = matrix(nrow = nrow(ASTROS_TANK_DF), ncol = ncol(ASTROS_TANK_DF))
LG_TANK_DF = as.data.frame(LG_TANK_DF)
colnames(LG_TANK_DF) = colnames(ASTROS_TANK_DF)
## Add years
for(i in 1:nrow(ASTROS_TANK_DF)){
ASTROS_TANK_DF[i,1] = seq(2011,2021)[i]
CUBS_TANK_DF[i,1] = seq(2011,2021)[i]
LG_TANK_DF[i,1] = seq(2011,2021)[i]
}
## Fill Win %
ASTROS_TANK_DF[ ,2] = StandALL$`W-L%`[ which(StandALL$Tm == "Houston Astros") ]
CUBS_TANK_DF[ ,2] = StandALL$`W-L%`[ which(StandALL$Tm == "Chicago Cubs") ]
LG_TANK_DF$`Win%` = 0.500
for (i in 11:21) {
ASTROS_TANK_DF[i-10,3] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Houston Astros" &
Year == paste(20,i,sep = "") &
Rd <= 5))
CUBS_TANK_DF[i-10,3] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Chicago Cubs" &
Year == paste(20,i,sep = "") &
Rd <= 5))
LG_TANK_DF[i-10,3] = round(nrow(LEAGUE_DRAFT_SUB %>%
dplyr::filter(Year == paste(20,i,sep = "") &
Rd <= 5)) / 28, digits = 2)
}
for (i in 11:21) {
ASTROS_TANK_DF[i-10,4] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Houston Astros" &
Year == paste(20,i,sep = "") &
POS == "SS"))
CUBS_TANK_DF[i-10,4] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Chicago Cubs" &
Year == paste(20,i,sep = "") &
POS == "SS"))
LG_TANK_DF[i-10,4] = round(nrow(LEAGUE_DRAFT_SUB %>%
dplyr::filter(Year == paste(20,i,sep = "") &
POS == "SS")) / 28, digits = 2)
}
for (i in 11:21) {
if (i <= 17) {
## # Pitchers
ASTROS_TANK_DF[i-10,5] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Houston Astros" &
Year == as.numeric(paste(20,i,sep = "")) &
POS == "P"))
CUBS_TANK_DF[i-10,5] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Chicago Cubs" &
Year == as.numeric(paste(20,i,sep = "")) &
POS == "P"))
LG_TANK_DF[i-10,5] = round(nrow(LEAGUE_DRAFT_SUB %>%
dplyr::filter(Year == as.numeric(paste(20,i,sep = "")) &
POS == "P")) / 28, digits = 2)
} else {
ASTROS_TANK_DF[i-10,5] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Houston Astros" &
Year == as.numeric(paste(20,i,sep = "")) &
grepl(POS, pattern = "RHP|LHP")))
CUBS_TANK_DF[i-10,5] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Chicago Cubs" &
Year == as.numeric(paste(20,i,sep = "")) &
grepl(POS, pattern = "RHP|LHP")))
LG_TANK_DF[i-10,5] = round(nrow(LEAGUE_DRAFT_SUB %>%
dplyr::filter(Year == as.numeric(paste(20,i,sep = "")) &
grepl(POS, pattern = "RHP|LHP"))) / 28, digits = 2)
}
for (i in 11:21) {
## # College picks
ASTROS_TANK_DF[i-10,6] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Houston Astros" &
Year == as.numeric(paste(20,i,sep = "")) &
grepl(`Drafted From`, pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC")))
CUBS_TANK_DF[i-10,6] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Chicago Cubs" &
Year == as.numeric(paste(20,i,sep = "")) &
grepl(`Drafted From`, pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC")))
LG_TANK_DF[i-10,6] = round(nrow(LEAGUE_DRAFT_SUB %>%
dplyr::filter(Year == as.numeric(paste(20,i,sep = "")) &
grepl(`Drafted From`, pattern = "University|College|UCLA|Cal Poly|Academy of Art|Institute of Technology|UNLV|State|Virginia Tech|Lipscomb|Santa Clara|Tusculum|JC"))) / 28, digits = 2)
}
for (i in 11:21){
## Total # Picks
ASTROS_TANK_DF[i-10,7] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Houston Astros" &
Year == as.numeric(paste(20,i,sep = ""))))
CUBS_TANK_DF[i-10,7] = nrow(ASTROS_CUBS_DRAFT_SUB %>%
dplyr::filter(Tm == "Chicago Cubs" &
Year == as.numeric(paste(20,i,sep = ""))))
LG_TANK_DF[i-10,7] = round(nrow(LEAGUE_DRAFT_SUB %>%
dplyr::filter(Year == as.numeric(paste(20,i,sep = "")))) / 28, digits = 2)
}
for (i in 11:21){
## # Intl Picks
ASTROS_TANK_DF[i-10,11] = nrow(IntlALL %>%
dplyr::filter(Team == "HOU" &
Year == as.numeric(paste(20,i,sep = ""))))
CUBS_TANK_DF[i-10,11] = nrow(IntlALL %>%
dplyr::filter(Team == "CHC" &
Year == as.numeric(paste(20,i,sep = ""))))
LG_TANK_DF[i-10,11] = round(nrow(IntlALL %>%
dplyr::filter(Year == as.numeric(paste(20,i,sep = "")) &
!grepl(Team, pattern = "(Astros)|(Cubs)"))) / 28, digits = 2)
}
for(i in 11:21){
## # FA signings
ASTROS_TANK_DF[i-10,13] = nrow(ESPN %>% ungroup() %>%
dplyr::filter(Team == "Astros" &
Type == "MLB" &
Year == as.numeric(paste(20,i,sep = ""))))
CUBS_TANK_DF[i-10,13] = nrow(ESPN %>% ungroup() %>%
dplyr::filter(Team == "Cubs" &
Type == "MLB" &
Year == as.numeric(paste(20,i,sep = ""))))
LG_TANK_DF[i-10,13] = round(nrow(ESPN %>% ungroup() %>%
dplyr::filter(Type == "MLB" &
!grepl(Team, pattern = "(Astros)|(Cubs)") &
Year == as.numeric(paste(20,i,sep = ""))))/ 28, digits = 2)
}
for(i in 11:21){
## FA avg AAV
ASTROS_TANK_DF[i-10,14] = round(mean(ESPN %>% ungroup() %>%
dplyr::filter(Team == "Astros" &
Type == "MLB" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(AAV) %>% unlist() %>% as.numeric(), na.rm = T), digits = 3)
CUBS_TANK_DF[i-10,14] = round(mean(ESPN %>% ungroup() %>%
dplyr::filter(Team == "Cubs" &
Type == "MLB" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(AAV) %>% unlist() %>% as.numeric(), na.rm = T), digits = 3)
LG_TANK_DF[i-10,14] = round(mean(ESPN %>% ungroup() %>%
dplyr::filter(Type == "MLB" &
!grepl(Team, pattern = "(Astros)|(Cubs)") &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(AAV) %>% unlist() %>% as.numeric(), na.rm = T), digits = 3)
}
for(i in 11:21){
## Contract Length Total
ASTROS_TANK_DF[i-10,15] = round(mean(ESPN %>% ungroup() %>%
dplyr::filter(Team == "Astros" &
Yrs != "" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(Yrs) %>% unlist() %>% as.numeric(), na.rm = T ), digits = 2)
CUBS_TANK_DF[i-10,15] = round(mean(ESPN %>% ungroup() %>%
dplyr::filter(Team == "Cubs" &
Yrs != "" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(Yrs) %>% unlist() %>% as.numeric(), na.rm = T), digits = 2)
LG_TANK_DF[i-10,15] = round(mean(ESPN %>% ungroup() %>%
dplyr::filter(Yrs != "" &
!grepl(Team, pattern = "(Astros)|(Cubs)") &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(Yrs) %>% unlist() %>% as.numeric(), na.rm = T), digits = 2)
}
for(i in 11:21){
## Contract Total Length
ASTROS_TANK_DF[i-10,16] = round(mean(ESPN %>% ungroup() %>%
dplyr::filter(Team == "Astros" &
Yrs != "" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(TotalValue) %>% unlist() %>% as.numeric(), na.rm = T), digits = 3)
CUBS_TANK_DF[i-10,16] = round(mean(ESPN %>% ungroup() %>%
dplyr::filter(Team == "Cubs" &
Yrs != "" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(TotalValue) %>% unlist() %>% as.numeric(), na.rm = T), digits = 3)
LG_TANK_DF[i-10,16] = round(mean(ESPN %>% ungroup() %>%
dplyr::filter(Yrs != "" &
Year == as.numeric(paste(20,i,sep = "")) &
!grepl(Team, pattern = "(Astros)|(Cubs)")) %>%
dplyr::select(TotalValue) %>% unlist() %>% as.numeric(), na.rm = T), digits = 3)
}
for (i in 11:21){
## Team WAR
if(i == 20) {
ASTROS_TANK_DF[i-10,17] = NA
CUBS_TANK_DF[i-10,17] = NA
LG_TANK_DF[i-10,17] = NA
} else {
ASTROS_TANK_DF[i-10,17] = round(TeamValALL %>% ungroup() %>%
dplyr::filter(Team == "Houston Astros" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(WAR) %>% unlist() %>% as.numeric(), digits = 1)
CUBS_TANK_DF[i-10,17] = round(TeamValALL %>% ungroup() %>%
dplyr::filter(Team == "Chicago Cubs" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(WAR) %>% unlist() %>% as.numeric(), digits = 1)
LG_TANK_DF[i-10,17] = round(median(TeamValALL %>% ungroup() %>%
dplyr::filter(!grepl(Team, pattern = "(Houston Astros)|(Chicago Cubs)") &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(WAR) %>% unlist() %>% as.numeric() ), digits = 1)
}
for(i in 11:21){
if(i == 20){
ASTROS_TANK_DF[i-10,18] = NA
CUBS_TANK_DF[i-10,18] = NA
LG_TANK_DF[i-10,18] = NA
} else {
## Team Salary
ASTROS_TANK_DF[i-10,18] = round(TeamValALL %>% ungroup() %>%
dplyr::filter(Team == "Houston Astros" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(Salary) %>% unlist() %>% as.numeric(), digits = 3)
CUBS_TANK_DF[i-10,18] = round(TeamValALL %>% ungroup() %>%
dplyr::filter(Team == "Chicago Cubs" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(Salary) %>% unlist() %>% as.numeric(), digits = 3)
LG_TANK_DF[i-10,18] = round(median(TeamValALL %>% ungroup() %>%
dplyr::filter(!grepl(Team, pattern = "(Houston Astros)|(Chicago Cubs)") &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(Salary) %>% unlist() %>% as.numeric() ), digits = 3)
}
## # Total Spent on Int'l FAs
for (i in 11:21) {
if (i == 11) {
ASTROS_TANK_DF[i-10,12] = 0
CUBS_TANK_DF[i-10,12] = sum(IntlALL %>%
dplyr::filter(Team == "CHC" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(Bonus) %>% unlist() %>% as.numeric(), na.rm = T)
LG_TANK_DF[i-10,12] = sum(IntlALL %>%
dplyr::filter(!grepl(Team, pattern = "(HOU)|(CHC)") &
Year == paste(20,i,sep = "")) %>%
dplyr::select(Bonus) %>% unlist() %>% as.numeric(), na.rm = T)
} else {
ASTROS_TANK_DF[i-10,12] = sum(IntlALL %>%
dplyr::filter(Team == "HOU" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(Bonus) %>% unlist() %>% as.numeric(), na.rm = T)
CUBS_TANK_DF[i-10,12] = sum(IntlALL %>%
dplyr::filter(Team == "CHC" &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(Bonus) %>% unlist() %>% as.numeric(), na.rm = T)
LG_TANK_DF[i-10,12] = sum(IntlALL %>%
dplyr::filter(!grepl(Team, pattern = "(HOU)|(CHC)") &
Year == as.numeric(paste(20,i,sep = ""))) %>%
dplyr::select(Bonus) %>% unlist() %>% as.numeric(), na.rm = T)
}
## Fill % of picks on SSs
ASTROS_TANK_DF[,8] = round((ASTROS_TANK_DF[,4] / ASTROS_TANK_DF[,7])*100, digits = 2)
CUBS_TANK_DF[,8] = round((CUBS_TANK_DF[,4] / CUBS_TANK_DF[,7])*100, digits = 2)
LG_TANK_DF[,8] = round((LG_TANK_DF[,4] / LG_TANK_DF[,7])*100, digits = 2)
## Fill % of picks on Ps
ASTROS_TANK_DF[,9] = round((ASTROS_TANK_DF[,5] / ASTROS_TANK_DF[,7])*100, digits = 2)
CUBS_TANK_DF[,9] = round((CUBS_TANK_DF[,5] / CUBS_TANK_DF[,7])*100, digits = 2)
LG_TANK_DF[,9] = round((LG_TANK_DF[,5] / LG_TANK_DF[,7])*100, digits = 2)
## Fill % of picks on college players
ASTROS_TANK_DF[,10] = round((ASTROS_TANK_DF[,6] / ASTROS_TANK_DF[,7])*100, digits = 2)
CUBS_TANK_DF[,10] = round((CUBS_TANK_DF[,6] / CUBS_TANK_DF[,7])*100, digits = 2)
LG_TANK_DF[,10] = round((LG_TANK_DF[,6] / LG_TANK_DF[,7])*100, digits = 2)
## Add Career WAR of draftees
ASTROS_TANK_DF = ASTROS_CUBS_DRAFT_SUB %>%
group_by(Year) %>%
filter(Tm == "Houston Astros") %>%
summarize(Draft_Class_Career_WAR = sum(Career_bWAR, na.rm = T)) %>%
select(Draft_Class_Career_WAR) %>%
bind_cols(ASTROS_TANK_DF)
ASTROS_TANK_DF = ASTROS_TANK_DF %>%
relocate(Draft_Class_Career_WAR, .after = 19)
CUBS_TANK_DF = ASTROS_CUBS_DRAFT_SUB %>%
group_by(Year) %>%
filter(Tm == "Chicago Cubs") %>%
summarize(Draft_Class_Career_WAR = sum(Career_bWAR, na.rm = T)) %>%
select(Draft_Class_Career_WAR) %>%
bind_cols(CUBS_TANK_DF)
CUBS_TANK_DF = CUBS_TANK_DF %>%
relocate(Draft_Class_Career_WAR, .after = 19)
LG_TANK_DF = LEAGUE_DRAFT_SUB %>%
group_by(Year) %>%
summarize(Draft_Class_Career_WAR = sum(Career_bWAR, na.rm = T)/28) %>%
select(Draft_Class_Career_WAR) %>%
bind_cols(LG_TANK_DF)
LG_TANK_DF = LG_TANK_DF %>%
relocate(Draft_Class_Career_WAR, .after = 19)
LG_TANK_DF[ , 19] = round(LG_TANK_DF[ , 19], digits = 1)
## Add "WARPM" (WAR Per Million $) col
ASTROS_TANK_DF$WARPM = round(ASTROS_TANK_DF$`Team bWAR` / ASTROS_TANK_DF$`Team payroll`, digits = 2)
CUBS_TANK_DF$WARPM = round(CUBS_TANK_DF$`Team bWAR` / CUBS_TANK_DF$`Team payroll`, digits = 2)
LG_TANK_DF$WARPM = round(LG_TANK_DF$`Team bWAR` / LG_TANK_DF$`Team payroll`, digits = 2)
## Add Team col
ASTROS_TANK_DF$Tm = "Houston Astros"
CUBS_TANK_DF$Tm = "Chicago Cubs"
LG_TANK_DF$Tm = "LeagueAVG"
TANK_DF = rbind.data.frame(ASTROS_TANK_DF, CUBS_TANK_DF, LG_TANK_DF)
TANK_DF = TANK_DF %>%
dplyr::select(Tm, Year, `Win%`, `# Top 5 picks`, `# SS Drafted`,
`# P Drafted`, `# College Draftees`, `# Draft Picks`,
`SS %`, `P %`, `College %`, `# Int'l Signings`,
`Int'l Signing Money Spent`, `# FA Contracts`, `Mean FA AAV`,
`Mean FA Length`, `Mean FA Total Value`, `Team bWAR`,
`Team payroll`, `Draft_Class_Career_WAR`, `WARPM`)
save.image("~/GitHub/Baseball/Tanking/WranglingEnvironment.RData")
## Data wrangling; df re-arrangement, string manipulations
library(readr)
# library(reshape2)
library(tidyverse)
# library(stringr)
## Web scraping
library(rvest)
library(XML)
## Plotting
library(ggplot2)
library(ggrepel)
# library(GGally)
library(ggpubr)
library(plotly)
## Modeling
library(mgcv)
library(splines)
load("~/GitHub/Baseball/Tanking/WranglingEnvironment.RData")
TeamValALL = TeamValALL %>%
dplyr::mutate(W_L = `W-L%`)
View(TeamValALL)
